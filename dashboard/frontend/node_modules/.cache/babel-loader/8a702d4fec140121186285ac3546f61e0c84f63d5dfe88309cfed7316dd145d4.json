{"ast":null,"code":"import _objectSpread from \"/home/saiadmin/k3s-cluster/dashboard/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nvar _Class;\nimport { selectSvgElement } from \"./chunk-EXTU4WIE.mjs\";\nimport { createText, getIconSVG, registerIconPacks, unknownIcon } from \"./chunk-JA3XYJ7Z.mjs\";\nimport { populateCommonDb } from \"./chunk-4BX2VUAB.mjs\";\nimport { cleanAndMerge, getEdgeId } from \"./chunk-S3R3BYOJ.mjs\";\nimport { clear, defaultConfig_default, getAccDescription, getAccTitle, getConfig, getConfig2, getDiagramTitle, sanitizeText, setAccDescription, setAccTitle, setDiagramTitle, setupGraphViewbox } from \"./chunk-ABZYJK2D.mjs\";\nimport { __name, log } from \"./chunk-AGHRB4JF.mjs\";\n\n// src/diagrams/architecture/architectureParser.ts\nimport { parse } from \"@mermaid-js/parser\";\n\n// src/diagrams/architecture/architectureTypes.ts\nvar ArchitectureDirectionName = {\n  L: \"left\",\n  R: \"right\",\n  T: \"top\",\n  B: \"bottom\"\n};\nvar ArchitectureDirectionArrow = {\n  L: /* @__PURE__ */__name(scale => \"\".concat(scale, \",\").concat(scale / 2, \" 0,\").concat(scale, \" 0,0\"), \"L\"),\n  R: /* @__PURE__ */__name(scale => \"0,\".concat(scale / 2, \" \").concat(scale, \",0 \").concat(scale, \",\").concat(scale), \"R\"),\n  T: /* @__PURE__ */__name(scale => \"0,0 \".concat(scale, \",0 \").concat(scale / 2, \",\").concat(scale), \"T\"),\n  B: /* @__PURE__ */__name(scale => \"\".concat(scale / 2, \",0 \").concat(scale, \",\").concat(scale, \" 0,\").concat(scale), \"B\")\n};\nvar ArchitectureDirectionArrowShift = {\n  L: /* @__PURE__ */__name((orig, arrowSize) => orig - arrowSize + 2, \"L\"),\n  R: /* @__PURE__ */__name((orig, _arrowSize) => orig - 2, \"R\"),\n  T: /* @__PURE__ */__name((orig, arrowSize) => orig - arrowSize + 2, \"T\"),\n  B: /* @__PURE__ */__name((orig, _arrowSize) => orig - 2, \"B\")\n};\nvar getOppositeArchitectureDirection = /* @__PURE__ */__name(function (x) {\n  if (isArchitectureDirectionX(x)) {\n    return x === \"L\" ? \"R\" : \"L\";\n  } else {\n    return x === \"T\" ? \"B\" : \"T\";\n  }\n}, \"getOppositeArchitectureDirection\");\nvar isArchitectureDirection = /* @__PURE__ */__name(function (x) {\n  const temp = x;\n  return temp === \"L\" || temp === \"R\" || temp === \"T\" || temp === \"B\";\n}, \"isArchitectureDirection\");\nvar isArchitectureDirectionX = /* @__PURE__ */__name(function (x) {\n  const temp = x;\n  return temp === \"L\" || temp === \"R\";\n}, \"isArchitectureDirectionX\");\nvar isArchitectureDirectionY = /* @__PURE__ */__name(function (x) {\n  const temp = x;\n  return temp === \"T\" || temp === \"B\";\n}, \"isArchitectureDirectionY\");\nvar isArchitectureDirectionXY = /* @__PURE__ */__name(function (a, b) {\n  const aX_bY = isArchitectureDirectionX(a) && isArchitectureDirectionY(b);\n  const aY_bX = isArchitectureDirectionY(a) && isArchitectureDirectionX(b);\n  return aX_bY || aY_bX;\n}, \"isArchitectureDirectionXY\");\nvar isArchitecturePairXY = /* @__PURE__ */__name(function (pair) {\n  const lhs = pair[0];\n  const rhs = pair[1];\n  const aX_bY = isArchitectureDirectionX(lhs) && isArchitectureDirectionY(rhs);\n  const aY_bX = isArchitectureDirectionY(lhs) && isArchitectureDirectionX(rhs);\n  return aX_bY || aY_bX;\n}, \"isArchitecturePairXY\");\nvar isValidArchitectureDirectionPair = /* @__PURE__ */__name(function (x) {\n  return x !== \"LL\" && x !== \"RR\" && x !== \"TT\" && x !== \"BB\";\n}, \"isValidArchitectureDirectionPair\");\nvar getArchitectureDirectionPair = /* @__PURE__ */__name(function (sourceDir, targetDir) {\n  const pair = \"\".concat(sourceDir).concat(targetDir);\n  return isValidArchitectureDirectionPair(pair) ? pair : void 0;\n}, \"getArchitectureDirectionPair\");\nvar shiftPositionByArchitectureDirectionPair = /* @__PURE__ */__name(function (_ref, pair) {\n  let [x, y] = _ref;\n  const lhs = pair[0];\n  const rhs = pair[1];\n  if (isArchitectureDirectionX(lhs)) {\n    if (isArchitectureDirectionY(rhs)) {\n      return [x + (lhs === \"L\" ? -1 : 1), y + (rhs === \"T\" ? 1 : -1)];\n    } else {\n      return [x + (lhs === \"L\" ? -1 : 1), y];\n    }\n  } else {\n    if (isArchitectureDirectionX(rhs)) {\n      return [x + (rhs === \"L\" ? 1 : -1), y + (lhs === \"T\" ? 1 : -1)];\n    } else {\n      return [x, y + (lhs === \"T\" ? 1 : -1)];\n    }\n  }\n}, \"shiftPositionByArchitectureDirectionPair\");\nvar getArchitectureDirectionXYFactors = /* @__PURE__ */__name(function (pair) {\n  if (pair === \"LT\" || pair === \"TL\") {\n    return [1, 1];\n  } else if (pair === \"BL\" || pair === \"LB\") {\n    return [1, -1];\n  } else if (pair === \"BR\" || pair === \"RB\") {\n    return [-1, -1];\n  } else {\n    return [-1, 1];\n  }\n}, \"getArchitectureDirectionXYFactors\");\nvar getArchitectureDirectionAlignment = /* @__PURE__ */__name(function (a, b) {\n  if (isArchitectureDirectionXY(a, b)) {\n    return \"bend\";\n  } else if (isArchitectureDirectionX(a)) {\n    return \"horizontal\";\n  }\n  return \"vertical\";\n}, \"getArchitectureDirectionAlignment\");\nvar isArchitectureService = /* @__PURE__ */__name(function (x) {\n  const temp = x;\n  return temp.type === \"service\";\n}, \"isArchitectureService\");\nvar isArchitectureJunction = /* @__PURE__ */__name(function (x) {\n  const temp = x;\n  return temp.type === \"junction\";\n}, \"isArchitectureJunction\");\nvar edgeData = /* @__PURE__ */__name(edge => {\n  return edge.data();\n}, \"edgeData\");\nvar nodeData = /* @__PURE__ */__name(node => {\n  return node.data();\n}, \"nodeData\");\n\n// src/diagrams/architecture/architectureDb.ts\nvar DEFAULT_ARCHITECTURE_CONFIG = defaultConfig_default.architecture;\nvar ArchitectureDB = (_Class = class ArchitectureDB {\n  constructor() {\n    this.nodes = {};\n    this.groups = {};\n    this.edges = [];\n    this.registeredIds = {};\n    this.elements = {};\n    this.setAccTitle = setAccTitle;\n    this.getAccTitle = getAccTitle;\n    this.setDiagramTitle = setDiagramTitle;\n    this.getDiagramTitle = getDiagramTitle;\n    this.getAccDescription = getAccDescription;\n    this.setAccDescription = setAccDescription;\n    this.clear();\n  }\n  clear() {\n    this.nodes = {};\n    this.groups = {};\n    this.edges = [];\n    this.registeredIds = {};\n    this.dataStructures = void 0;\n    this.elements = {};\n    clear();\n  }\n  addService(_ref2) {\n    let {\n      id,\n      icon,\n      in: parent,\n      title,\n      iconText\n    } = _ref2;\n    if (this.registeredIds[id] !== void 0) {\n      throw new Error(\"The service id [\".concat(id, \"] is already in use by another \").concat(this.registeredIds[id]));\n    }\n    if (parent !== void 0) {\n      if (id === parent) {\n        throw new Error(\"The service [\".concat(id, \"] cannot be placed within itself\"));\n      }\n      if (this.registeredIds[parent] === void 0) {\n        throw new Error(\"The service [\".concat(id, \"]'s parent does not exist. Please make sure the parent is created before this service\"));\n      }\n      if (this.registeredIds[parent] === \"node\") {\n        throw new Error(\"The service [\".concat(id, \"]'s parent is not a group\"));\n      }\n    }\n    this.registeredIds[id] = \"node\";\n    this.nodes[id] = {\n      id,\n      type: \"service\",\n      icon,\n      iconText,\n      title,\n      edges: [],\n      in: parent\n    };\n  }\n  getServices() {\n    return Object.values(this.nodes).filter(isArchitectureService);\n  }\n  addJunction(_ref3) {\n    let {\n      id,\n      in: parent\n    } = _ref3;\n    this.registeredIds[id] = \"node\";\n    this.nodes[id] = {\n      id,\n      type: \"junction\",\n      edges: [],\n      in: parent\n    };\n  }\n  getJunctions() {\n    return Object.values(this.nodes).filter(isArchitectureJunction);\n  }\n  getNodes() {\n    return Object.values(this.nodes);\n  }\n  getNode(id) {\n    var _this$nodes$id;\n    return (_this$nodes$id = this.nodes[id]) !== null && _this$nodes$id !== void 0 ? _this$nodes$id : null;\n  }\n  addGroup(_ref4) {\n    var _this$registeredIds;\n    let {\n      id,\n      icon,\n      in: parent,\n      title\n    } = _ref4;\n    if (((_this$registeredIds = this.registeredIds) === null || _this$registeredIds === void 0 ? void 0 : _this$registeredIds[id]) !== void 0) {\n      throw new Error(\"The group id [\".concat(id, \"] is already in use by another \").concat(this.registeredIds[id]));\n    }\n    if (parent !== void 0) {\n      var _this$registeredIds2, _this$registeredIds3;\n      if (id === parent) {\n        throw new Error(\"The group [\".concat(id, \"] cannot be placed within itself\"));\n      }\n      if (((_this$registeredIds2 = this.registeredIds) === null || _this$registeredIds2 === void 0 ? void 0 : _this$registeredIds2[parent]) === void 0) {\n        throw new Error(\"The group [\".concat(id, \"]'s parent does not exist. Please make sure the parent is created before this group\"));\n      }\n      if (((_this$registeredIds3 = this.registeredIds) === null || _this$registeredIds3 === void 0 ? void 0 : _this$registeredIds3[parent]) === \"node\") {\n        throw new Error(\"The group [\".concat(id, \"]'s parent is not a group\"));\n      }\n    }\n    this.registeredIds[id] = \"group\";\n    this.groups[id] = {\n      id,\n      icon,\n      title,\n      in: parent\n    };\n  }\n  getGroups() {\n    return Object.values(this.groups);\n  }\n  addEdge(_ref5) {\n    let {\n      lhsId,\n      rhsId,\n      lhsDir,\n      rhsDir,\n      lhsInto,\n      rhsInto,\n      lhsGroup,\n      rhsGroup,\n      title\n    } = _ref5;\n    if (!isArchitectureDirection(lhsDir)) {\n      throw new Error(\"Invalid direction given for left hand side of edge \".concat(lhsId, \"--\").concat(rhsId, \". Expected (L,R,T,B) got \").concat(String(lhsDir)));\n    }\n    if (!isArchitectureDirection(rhsDir)) {\n      throw new Error(\"Invalid direction given for right hand side of edge \".concat(lhsId, \"--\").concat(rhsId, \". Expected (L,R,T,B) got \").concat(String(rhsDir)));\n    }\n    if (this.nodes[lhsId] === void 0 && this.groups[lhsId] === void 0) {\n      throw new Error(\"The left-hand id [\".concat(lhsId, \"] does not yet exist. Please create the service/group before declaring an edge to it.\"));\n    }\n    if (this.nodes[rhsId] === void 0 && this.groups[rhsId] === void 0) {\n      throw new Error(\"The right-hand id [\".concat(rhsId, \"] does not yet exist. Please create the service/group before declaring an edge to it.\"));\n    }\n    const lhsGroupId = this.nodes[lhsId].in;\n    const rhsGroupId = this.nodes[rhsId].in;\n    if (lhsGroup && lhsGroupId && rhsGroupId && lhsGroupId == rhsGroupId) {\n      throw new Error(\"The left-hand id [\".concat(lhsId, \"] is modified to traverse the group boundary, but the edge does not pass through two groups.\"));\n    }\n    if (rhsGroup && lhsGroupId && rhsGroupId && lhsGroupId == rhsGroupId) {\n      throw new Error(\"The right-hand id [\".concat(rhsId, \"] is modified to traverse the group boundary, but the edge does not pass through two groups.\"));\n    }\n    const edge = {\n      lhsId,\n      lhsDir,\n      lhsInto,\n      lhsGroup,\n      rhsId,\n      rhsDir,\n      rhsInto,\n      rhsGroup,\n      title\n    };\n    this.edges.push(edge);\n    if (this.nodes[lhsId] && this.nodes[rhsId]) {\n      this.nodes[lhsId].edges.push(this.edges[this.edges.length - 1]);\n      this.nodes[rhsId].edges.push(this.edges[this.edges.length - 1]);\n    }\n  }\n  getEdges() {\n    return this.edges;\n  }\n  /**\n   * Returns the current diagram's adjacency list, spatial map, & group alignments.\n   * If they have not been created, run the algorithms to generate them.\n   * @returns\n   */\n  getDataStructures() {\n    if (this.dataStructures === void 0) {\n      const groupAlignments = {};\n      const adjList = Object.entries(this.nodes).reduce((prevOuter, _ref6) => {\n        let [id, service] = _ref6;\n        prevOuter[id] = service.edges.reduce((prevInner, edge) => {\n          var _this$getNode, _this$getNode2;\n          const lhsGroupId = (_this$getNode = this.getNode(edge.lhsId)) === null || _this$getNode === void 0 ? void 0 : _this$getNode.in;\n          const rhsGroupId = (_this$getNode2 = this.getNode(edge.rhsId)) === null || _this$getNode2 === void 0 ? void 0 : _this$getNode2.in;\n          if (lhsGroupId && rhsGroupId && lhsGroupId !== rhsGroupId) {\n            const alignment = getArchitectureDirectionAlignment(edge.lhsDir, edge.rhsDir);\n            if (alignment !== \"bend\") {\n              var _groupAlignments$lhsG, _groupAlignments$rhsG;\n              (_groupAlignments$lhsG = groupAlignments[lhsGroupId]) !== null && _groupAlignments$lhsG !== void 0 ? _groupAlignments$lhsG : groupAlignments[lhsGroupId] = {};\n              groupAlignments[lhsGroupId][rhsGroupId] = alignment;\n              (_groupAlignments$rhsG = groupAlignments[rhsGroupId]) !== null && _groupAlignments$rhsG !== void 0 ? _groupAlignments$rhsG : groupAlignments[rhsGroupId] = {};\n              groupAlignments[rhsGroupId][lhsGroupId] = alignment;\n            }\n          }\n          if (edge.lhsId === id) {\n            const pair = getArchitectureDirectionPair(edge.lhsDir, edge.rhsDir);\n            if (pair) {\n              prevInner[pair] = edge.rhsId;\n            }\n          } else {\n            const pair = getArchitectureDirectionPair(edge.rhsDir, edge.lhsDir);\n            if (pair) {\n              prevInner[pair] = edge.lhsId;\n            }\n          }\n          return prevInner;\n        }, {});\n        return prevOuter;\n      }, {});\n      const firstId = Object.keys(adjList)[0];\n      const visited = {\n        [firstId]: 1\n      };\n      const notVisited = Object.keys(adjList).reduce((prev, id) => id === firstId ? prev : _objectSpread(_objectSpread({}, prev), {}, {\n        [id]: 1\n      }), {});\n      const BFS = /* @__PURE__ */__name(startingId => {\n        const spatialMap = {\n          [startingId]: [0, 0]\n        };\n        const queue = [startingId];\n        while (queue.length > 0) {\n          const id = queue.shift();\n          if (id) {\n            visited[id] = 1;\n            delete notVisited[id];\n            const adj = adjList[id];\n            const [posX, posY] = spatialMap[id];\n            Object.entries(adj).forEach(_ref7 => {\n              let [dir, rhsId] = _ref7;\n              if (!visited[rhsId]) {\n                spatialMap[rhsId] = shiftPositionByArchitectureDirectionPair([posX, posY], dir);\n                queue.push(rhsId);\n              }\n            });\n          }\n        }\n        return spatialMap;\n      }, \"BFS\");\n      const spatialMaps = [BFS(firstId)];\n      while (Object.keys(notVisited).length > 0) {\n        spatialMaps.push(BFS(Object.keys(notVisited)[0]));\n      }\n      this.dataStructures = {\n        adjList,\n        spatialMaps,\n        groupAlignments\n      };\n    }\n    return this.dataStructures;\n  }\n  setElementForId(id, element) {\n    this.elements[id] = element;\n  }\n  getElementById(id) {\n    return this.elements[id];\n  }\n  getConfig() {\n    return cleanAndMerge(_objectSpread(_objectSpread({}, DEFAULT_ARCHITECTURE_CONFIG), getConfig().architecture));\n  }\n  getConfigField(field) {\n    return this.getConfig()[field];\n  }\n}, __name(_Class, \"ArchitectureDB\"), _Class);\n\n// src/diagrams/architecture/architectureParser.ts\nvar populateDb = /* @__PURE__ */__name((ast, db) => {\n  populateCommonDb(ast, db);\n  ast.groups.map(group => db.addGroup(group));\n  ast.services.map(service => db.addService(_objectSpread(_objectSpread({}, service), {}, {\n    type: \"service\"\n  })));\n  ast.junctions.map(service => db.addJunction(_objectSpread(_objectSpread({}, service), {}, {\n    type: \"junction\"\n  })));\n  ast.edges.map(edge => db.addEdge(edge));\n}, \"populateDb\");\nvar parser = {\n  parser: {\n    // @ts-expect-error - ArchitectureDB is not assignable to DiagramDB\n    yy: void 0\n  },\n  parse: /* @__PURE__ */__name(async input => {\n    var _parser$parser;\n    const ast = await parse(\"architecture\", input);\n    log.debug(ast);\n    const db = (_parser$parser = parser.parser) === null || _parser$parser === void 0 ? void 0 : _parser$parser.yy;\n    if (!(db instanceof ArchitectureDB)) {\n      throw new Error(\"parser.parser?.yy was not a ArchitectureDB. This is due to a bug within Mermaid, please report this issue at https://github.com/mermaid-js/mermaid/issues.\");\n    }\n    populateDb(ast, db);\n  }, \"parse\")\n};\n\n// src/diagrams/architecture/architectureStyles.ts\nvar getStyles = /* @__PURE__ */__name(options => \"\\n  .edge {\\n    stroke-width: \".concat(options.archEdgeWidth, \";\\n    stroke: \").concat(options.archEdgeColor, \";\\n    fill: none;\\n  }\\n\\n  .arrow {\\n    fill: \").concat(options.archEdgeArrowColor, \";\\n  }\\n\\n  .node-bkg {\\n    fill: none;\\n    stroke: \").concat(options.archGroupBorderColor, \";\\n    stroke-width: \").concat(options.archGroupBorderWidth, \";\\n    stroke-dasharray: 8;\\n  }\\n  .node-icon-text {\\n    display: flex; \\n    align-items: center;\\n  }\\n  \\n  .node-icon-text > div {\\n    color: #fff;\\n    margin: 1px;\\n    height: fit-content;\\n    text-align: center;\\n    overflow: hidden;\\n    display: -webkit-box;\\n    -webkit-box-orient: vertical;\\n  }\\n\"), \"getStyles\");\nvar architectureStyles_default = getStyles;\n\n// src/diagrams/architecture/architectureRenderer.ts\nimport cytoscape from \"cytoscape\";\nimport fcose from \"cytoscape-fcose\";\nimport { select } from \"d3\";\n\n// src/diagrams/architecture/architectureIcons.ts\nvar wrapIcon = /* @__PURE__ */__name(icon => {\n  return \"<g><rect width=\\\"80\\\" height=\\\"80\\\" style=\\\"fill: #087ebf; stroke-width: 0px;\\\"/>\".concat(icon, \"</g>\");\n}, \"wrapIcon\");\nvar architectureIcons = {\n  prefix: \"mermaid-architecture\",\n  height: 80,\n  width: 80,\n  icons: {\n    database: {\n      body: wrapIcon('<path id=\"b\" data-name=\"4\" d=\"m20,57.86c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path id=\"c\" data-name=\"3\" d=\"m20,45.95c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path id=\"d\" data-name=\"2\" d=\"m20,34.05c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse id=\"e\" data-name=\"1\" cx=\"40\" cy=\"22.14\" rx=\"20\" ry=\"7.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"20\" y1=\"57.86\" x2=\"20\" y2=\"22.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"60\" y1=\"57.86\" x2=\"60\" y2=\"22.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/>')\n    },\n    server: {\n      body: wrapIcon('<rect x=\"17.5\" y=\"17.5\" width=\"45\" height=\"45\" rx=\"2\" ry=\"2\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"17.5\" y1=\"32.5\" x2=\"62.5\" y2=\"32.5\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"17.5\" y1=\"47.5\" x2=\"62.5\" y2=\"47.5\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><g><path d=\"m56.25,25c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: #fff; stroke-width: 0px;\"/><path d=\"m56.25,25c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><path d=\"m56.25,40c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: #fff; stroke-width: 0px;\"/><path d=\"m56.25,40c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><path d=\"m56.25,55c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: #fff; stroke-width: 0px;\"/><path d=\"m56.25,55c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><circle cx=\"32.5\" cy=\"25\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"27.5\" cy=\"25\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"22.5\" cy=\"25\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><circle cx=\"32.5\" cy=\"40\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"27.5\" cy=\"40\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"22.5\" cy=\"40\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><circle cx=\"32.5\" cy=\"55\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"27.5\" cy=\"55\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"22.5\" cy=\"55\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/></g>')\n    },\n    disk: {\n      body: wrapIcon('<rect x=\"20\" y=\"15\" width=\"40\" height=\"50\" rx=\"1\" ry=\"1\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"24\" cy=\"19.17\" rx=\".8\" ry=\".83\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"56\" cy=\"19.17\" rx=\".8\" ry=\".83\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"24\" cy=\"60.83\" rx=\".8\" ry=\".83\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"56\" cy=\"60.83\" rx=\".8\" ry=\".83\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"40\" cy=\"33.75\" rx=\"14\" ry=\"14.58\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"40\" cy=\"33.75\" rx=\"4\" ry=\"4.17\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path d=\"m37.51,42.52l-4.83,13.22c-.26.71-1.1,1.02-1.76.64l-4.18-2.42c-.66-.38-.81-1.26-.33-1.84l9.01-10.8c.88-1.05,2.56-.08,2.09,1.2Z\" style=\"fill: #fff; stroke-width: 0px;\"/>')\n    },\n    internet: {\n      body: wrapIcon('<circle cx=\"40\" cy=\"40\" r=\"22.5\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"40\" y1=\"17.5\" x2=\"40\" y2=\"62.5\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"17.5\" y1=\"40\" x2=\"62.5\" y2=\"40\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path d=\"m39.99,17.51c-15.28,11.1-15.28,33.88,0,44.98\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path d=\"m40.01,17.51c15.28,11.1,15.28,33.88,0,44.98\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"19.75\" y1=\"30.1\" x2=\"60.25\" y2=\"30.1\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"19.75\" y1=\"49.9\" x2=\"60.25\" y2=\"49.9\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/>')\n    },\n    cloud: {\n      body: wrapIcon('<path d=\"m65,47.5c0,2.76-2.24,5-5,5H20c-2.76,0-5-2.24-5-5,0-1.87,1.03-3.51,2.56-4.36-.04-.21-.06-.42-.06-.64,0-2.6,2.48-4.74,5.65-4.97,1.65-4.51,6.34-7.76,11.85-7.76.86,0,1.69.08,2.5.23,2.09-1.57,4.69-2.5,7.5-2.5,6.1,0,11.19,4.38,12.28,10.17,2.14.56,3.72,2.51,3.72,4.83,0,.03,0,.07-.01.1,2.29.46,4.01,2.48,4.01,4.9Z\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/>')\n    },\n    unknown: unknownIcon,\n    blank: {\n      body: wrapIcon(\"\")\n    }\n  }\n};\n\n// src/diagrams/architecture/svgDraw.ts\nvar drawEdges = /* @__PURE__ */__name(async function (edgesEl, cy, db) {\n  const padding = db.getConfigField(\"padding\");\n  const iconSize = db.getConfigField(\"iconSize\");\n  const halfIconSize = iconSize / 2;\n  const arrowSize = iconSize / 6;\n  const halfArrowSize = arrowSize / 2;\n  await Promise.all(cy.edges().map(async edge => {\n    var _db$getNode, _db$getNode2;\n    const {\n      source,\n      sourceDir,\n      sourceArrow,\n      sourceGroup,\n      target,\n      targetDir,\n      targetArrow,\n      targetGroup,\n      label\n    } = edgeData(edge);\n    let {\n      x: startX,\n      y: startY\n    } = edge[0].sourceEndpoint();\n    const {\n      x: midX,\n      y: midY\n    } = edge[0].midpoint();\n    let {\n      x: endX,\n      y: endY\n    } = edge[0].targetEndpoint();\n    const groupEdgeShift = padding + 4;\n    if (sourceGroup) {\n      if (isArchitectureDirectionX(sourceDir)) {\n        startX += sourceDir === \"L\" ? -groupEdgeShift : groupEdgeShift;\n      } else {\n        startY += sourceDir === \"T\" ? -groupEdgeShift : groupEdgeShift + 18;\n      }\n    }\n    if (targetGroup) {\n      if (isArchitectureDirectionX(targetDir)) {\n        endX += targetDir === \"L\" ? -groupEdgeShift : groupEdgeShift;\n      } else {\n        endY += targetDir === \"T\" ? -groupEdgeShift : groupEdgeShift + 18;\n      }\n    }\n    if (!sourceGroup && ((_db$getNode = db.getNode(source)) === null || _db$getNode === void 0 ? void 0 : _db$getNode.type) === \"junction\") {\n      if (isArchitectureDirectionX(sourceDir)) {\n        startX += sourceDir === \"L\" ? halfIconSize : -halfIconSize;\n      } else {\n        startY += sourceDir === \"T\" ? halfIconSize : -halfIconSize;\n      }\n    }\n    if (!targetGroup && ((_db$getNode2 = db.getNode(target)) === null || _db$getNode2 === void 0 ? void 0 : _db$getNode2.type) === \"junction\") {\n      if (isArchitectureDirectionX(targetDir)) {\n        endX += targetDir === \"L\" ? halfIconSize : -halfIconSize;\n      } else {\n        endY += targetDir === \"T\" ? halfIconSize : -halfIconSize;\n      }\n    }\n    if (edge[0]._private.rscratch) {\n      const g = edgesEl.insert(\"g\");\n      g.insert(\"path\").attr(\"d\", \"M \".concat(startX, \",\").concat(startY, \" L \").concat(midX, \",\").concat(midY, \" L\").concat(endX, \",\").concat(endY, \" \")).attr(\"class\", \"edge\").attr(\"id\", getEdgeId(source, target, {\n        prefix: \"L\"\n      }));\n      if (sourceArrow) {\n        const xShift = isArchitectureDirectionX(sourceDir) ? ArchitectureDirectionArrowShift[sourceDir](startX, arrowSize) : startX - halfArrowSize;\n        const yShift = isArchitectureDirectionY(sourceDir) ? ArchitectureDirectionArrowShift[sourceDir](startY, arrowSize) : startY - halfArrowSize;\n        g.insert(\"polygon\").attr(\"points\", ArchitectureDirectionArrow[sourceDir](arrowSize)).attr(\"transform\", \"translate(\".concat(xShift, \",\").concat(yShift, \")\")).attr(\"class\", \"arrow\");\n      }\n      if (targetArrow) {\n        const xShift = isArchitectureDirectionX(targetDir) ? ArchitectureDirectionArrowShift[targetDir](endX, arrowSize) : endX - halfArrowSize;\n        const yShift = isArchitectureDirectionY(targetDir) ? ArchitectureDirectionArrowShift[targetDir](endY, arrowSize) : endY - halfArrowSize;\n        g.insert(\"polygon\").attr(\"points\", ArchitectureDirectionArrow[targetDir](arrowSize)).attr(\"transform\", \"translate(\".concat(xShift, \",\").concat(yShift, \")\")).attr(\"class\", \"arrow\");\n      }\n      if (label) {\n        const axis = !isArchitectureDirectionXY(sourceDir, targetDir) ? isArchitectureDirectionX(sourceDir) ? \"X\" : \"Y\" : \"XY\";\n        let width = 0;\n        if (axis === \"X\") {\n          width = Math.abs(startX - endX);\n        } else if (axis === \"Y\") {\n          width = Math.abs(startY - endY) / 1.5;\n        } else {\n          width = Math.abs(startX - endX) / 2;\n        }\n        const textElem = g.append(\"g\");\n        await createText(textElem, label, {\n          useHtmlLabels: false,\n          width,\n          classes: \"architecture-service-label\"\n        }, getConfig2());\n        textElem.attr(\"dy\", \"1em\").attr(\"alignment-baseline\", \"middle\").attr(\"dominant-baseline\", \"middle\").attr(\"text-anchor\", \"middle\");\n        if (axis === \"X\") {\n          textElem.attr(\"transform\", \"translate(\" + midX + \", \" + midY + \")\");\n        } else if (axis === \"Y\") {\n          textElem.attr(\"transform\", \"translate(\" + midX + \", \" + midY + \") rotate(-90)\");\n        } else if (axis === \"XY\") {\n          const pair = getArchitectureDirectionPair(sourceDir, targetDir);\n          if (pair && isArchitecturePairXY(pair)) {\n            const bboxOrig = textElem.node().getBoundingClientRect();\n            const [x, y] = getArchitectureDirectionXYFactors(pair);\n            textElem.attr(\"dominant-baseline\", \"auto\").attr(\"transform\", \"rotate(\".concat(-1 * x * y * 45, \")\"));\n            const bboxNew = textElem.node().getBoundingClientRect();\n            textElem.attr(\"transform\", \"\\n                translate(\".concat(midX, \", \").concat(midY - bboxOrig.height / 2, \")\\n                translate(\").concat(x * bboxNew.width / 2, \", \").concat(y * bboxNew.height / 2, \")\\n                rotate(\").concat(-1 * x * y * 45, \", 0, \").concat(bboxOrig.height / 2, \")\\n              \"));\n          }\n        }\n      }\n    }\n  }));\n}, \"drawEdges\");\nvar drawGroups = /* @__PURE__ */__name(async function (groupsEl, cy, db) {\n  const padding = db.getConfigField(\"padding\");\n  const groupIconSize = padding * 0.75;\n  const fontSize = db.getConfigField(\"fontSize\");\n  const iconSize = db.getConfigField(\"iconSize\");\n  const halfIconSize = iconSize / 2;\n  await Promise.all(cy.nodes().map(async node => {\n    const data = nodeData(node);\n    if (data.type === \"group\") {\n      const {\n        h,\n        w,\n        x1,\n        y1\n      } = node.boundingBox();\n      const groupsNode = groupsEl.append(\"rect\");\n      groupsNode.attr(\"id\", \"group-\".concat(data.id)).attr(\"x\", x1 + halfIconSize).attr(\"y\", y1 + halfIconSize).attr(\"width\", w).attr(\"height\", h).attr(\"class\", \"node-bkg\");\n      const groupLabelContainer = groupsEl.append(\"g\");\n      let shiftedX1 = x1;\n      let shiftedY1 = y1;\n      if (data.icon) {\n        const bkgElem = groupLabelContainer.append(\"g\");\n        bkgElem.html(\"<g>\".concat(await getIconSVG(data.icon, {\n          height: groupIconSize,\n          width: groupIconSize,\n          fallbackPrefix: architectureIcons.prefix\n        }), \"</g>\"));\n        bkgElem.attr(\"transform\", \"translate(\" + (shiftedX1 + halfIconSize + 1) + \", \" + (shiftedY1 + halfIconSize + 1) + \")\");\n        shiftedX1 += groupIconSize;\n        shiftedY1 += fontSize / 2 - 1 - 2;\n      }\n      if (data.label) {\n        const textElem = groupLabelContainer.append(\"g\");\n        await createText(textElem, data.label, {\n          useHtmlLabels: false,\n          width: w,\n          classes: \"architecture-service-label\"\n        }, getConfig2());\n        textElem.attr(\"dy\", \"1em\").attr(\"alignment-baseline\", \"middle\").attr(\"dominant-baseline\", \"start\").attr(\"text-anchor\", \"start\");\n        textElem.attr(\"transform\", \"translate(\" + (shiftedX1 + halfIconSize + 4) + \", \" + (shiftedY1 + halfIconSize + 2) + \")\");\n      }\n      db.setElementForId(data.id, groupsNode);\n    }\n  }));\n}, \"drawGroups\");\nvar drawServices = /* @__PURE__ */__name(async function (db, elem, services) {\n  const config = getConfig2();\n  for (const service of services) {\n    const serviceElem = elem.append(\"g\");\n    const iconSize = db.getConfigField(\"iconSize\");\n    if (service.title) {\n      const textElem = serviceElem.append(\"g\");\n      await createText(textElem, service.title, {\n        useHtmlLabels: false,\n        width: iconSize * 1.5,\n        classes: \"architecture-service-label\"\n      }, config);\n      textElem.attr(\"dy\", \"1em\").attr(\"alignment-baseline\", \"middle\").attr(\"dominant-baseline\", \"middle\").attr(\"text-anchor\", \"middle\");\n      textElem.attr(\"transform\", \"translate(\" + iconSize / 2 + \", \" + iconSize + \")\");\n    }\n    const bkgElem = serviceElem.append(\"g\");\n    if (service.icon) {\n      bkgElem.html(\"<g>\".concat(await getIconSVG(service.icon, {\n        height: iconSize,\n        width: iconSize,\n        fallbackPrefix: architectureIcons.prefix\n      }), \"</g>\"));\n    } else if (service.iconText) {\n      var _parseInt;\n      bkgElem.html(\"<g>\".concat(await getIconSVG(\"blank\", {\n        height: iconSize,\n        width: iconSize,\n        fallbackPrefix: architectureIcons.prefix\n      }), \"</g>\"));\n      const textElemContainer = bkgElem.append(\"g\");\n      const fo = textElemContainer.append(\"foreignObject\").attr(\"width\", iconSize).attr(\"height\", iconSize);\n      const divElem = fo.append(\"div\").attr(\"class\", \"node-icon-text\").attr(\"style\", \"height: \".concat(iconSize, \"px;\")).append(\"div\").html(sanitizeText(service.iconText, config));\n      const fontSize = (_parseInt = parseInt(window.getComputedStyle(divElem.node(), null).getPropertyValue(\"font-size\").replace(/\\D/g, \"\"))) !== null && _parseInt !== void 0 ? _parseInt : 16;\n      divElem.attr(\"style\", \"-webkit-line-clamp: \".concat(Math.floor((iconSize - 2) / fontSize), \";\"));\n    } else {\n      bkgElem.append(\"path\").attr(\"class\", \"node-bkg\").attr(\"id\", \"node-\" + service.id).attr(\"d\", \"M0 \".concat(iconSize, \" v\").concat(-iconSize, \" q0,-5 5,-5 h\").concat(iconSize, \" q5,0 5,5 v\").concat(iconSize, \" H0 Z\"));\n    }\n    serviceElem.attr(\"id\", \"service-\".concat(service.id)).attr(\"class\", \"architecture-service\");\n    const {\n      width,\n      height\n    } = serviceElem.node().getBBox();\n    service.width = width;\n    service.height = height;\n    db.setElementForId(service.id, serviceElem);\n  }\n  return 0;\n}, \"drawServices\");\nvar drawJunctions = /* @__PURE__ */__name(function (db, elem, junctions) {\n  junctions.forEach(junction => {\n    const junctionElem = elem.append(\"g\");\n    const iconSize = db.getConfigField(\"iconSize\");\n    const bkgElem = junctionElem.append(\"g\");\n    bkgElem.append(\"rect\").attr(\"id\", \"node-\" + junction.id).attr(\"fill-opacity\", \"0\").attr(\"width\", iconSize).attr(\"height\", iconSize);\n    junctionElem.attr(\"class\", \"architecture-junction\");\n    const {\n      width,\n      height\n    } = junctionElem._groups[0][0].getBBox();\n    junctionElem.width = width;\n    junctionElem.height = height;\n    db.setElementForId(junction.id, junctionElem);\n  });\n}, \"drawJunctions\");\n\n// src/diagrams/architecture/architectureRenderer.ts\nregisterIconPacks([{\n  name: architectureIcons.prefix,\n  icons: architectureIcons\n}]);\ncytoscape.use(fcose);\nfunction addServices(services, cy, db) {\n  services.forEach(service => {\n    cy.add({\n      group: \"nodes\",\n      data: {\n        type: \"service\",\n        id: service.id,\n        icon: service.icon,\n        label: service.title,\n        parent: service.in,\n        width: db.getConfigField(\"iconSize\"),\n        height: db.getConfigField(\"iconSize\")\n      },\n      classes: \"node-service\"\n    });\n  });\n}\n__name(addServices, \"addServices\");\nfunction addJunctions(junctions, cy, db) {\n  junctions.forEach(junction => {\n    cy.add({\n      group: \"nodes\",\n      data: {\n        type: \"junction\",\n        id: junction.id,\n        parent: junction.in,\n        width: db.getConfigField(\"iconSize\"),\n        height: db.getConfigField(\"iconSize\")\n      },\n      classes: \"node-junction\"\n    });\n  });\n}\n__name(addJunctions, \"addJunctions\");\nfunction positionNodes(db, cy) {\n  cy.nodes().map(node => {\n    const data = nodeData(node);\n    if (data.type === \"group\") {\n      return;\n    }\n    data.x = node.position().x;\n    data.y = node.position().y;\n    const nodeElem = db.getElementById(data.id);\n    nodeElem.attr(\"transform\", \"translate(\" + (data.x || 0) + \",\" + (data.y || 0) + \")\");\n  });\n}\n__name(positionNodes, \"positionNodes\");\nfunction addGroups(groups, cy) {\n  groups.forEach(group => {\n    cy.add({\n      group: \"nodes\",\n      data: {\n        type: \"group\",\n        id: group.id,\n        icon: group.icon,\n        label: group.title,\n        parent: group.in\n      },\n      classes: \"node-group\"\n    });\n  });\n}\n__name(addGroups, \"addGroups\");\nfunction addEdges(edges, cy) {\n  edges.forEach(parsedEdge => {\n    const {\n      lhsId,\n      rhsId,\n      lhsInto,\n      lhsGroup,\n      rhsInto,\n      lhsDir,\n      rhsDir,\n      rhsGroup,\n      title\n    } = parsedEdge;\n    const edgeType = isArchitectureDirectionXY(parsedEdge.lhsDir, parsedEdge.rhsDir) ? \"segments\" : \"straight\";\n    const edge = {\n      id: \"\".concat(lhsId, \"-\").concat(rhsId),\n      label: title,\n      source: lhsId,\n      sourceDir: lhsDir,\n      sourceArrow: lhsInto,\n      sourceGroup: lhsGroup,\n      sourceEndpoint: lhsDir === \"L\" ? \"0 50%\" : lhsDir === \"R\" ? \"100% 50%\" : lhsDir === \"T\" ? \"50% 0\" : \"50% 100%\",\n      target: rhsId,\n      targetDir: rhsDir,\n      targetArrow: rhsInto,\n      targetGroup: rhsGroup,\n      targetEndpoint: rhsDir === \"L\" ? \"0 50%\" : rhsDir === \"R\" ? \"100% 50%\" : rhsDir === \"T\" ? \"50% 0\" : \"50% 100%\"\n    };\n    cy.add({\n      group: \"edges\",\n      data: edge,\n      classes: edgeType\n    });\n  });\n}\n__name(addEdges, \"addEdges\");\nfunction getAlignments(db, spatialMaps, groupAlignments) {\n  const flattenAlignments = /* @__PURE__ */__name((alignmentObj, alignmentDir) => {\n    return Object.entries(alignmentObj).reduce((prev, _ref8) => {\n      let [dir, alignments2] = _ref8;\n      let cnt = 0;\n      const arr = Object.entries(alignments2);\n      if (arr.length === 1) {\n        prev[dir] = arr[0][1];\n        return prev;\n      }\n      for (let i = 0; i < arr.length - 1; i++) {\n        for (let j = i + 1; j < arr.length; j++) {\n          var _groupAlignments$aGro;\n          const [aGroupId, aNodeIds] = arr[i];\n          const [bGroupId, bNodeIds] = arr[j];\n          const alignment = (_groupAlignments$aGro = groupAlignments[aGroupId]) === null || _groupAlignments$aGro === void 0 ? void 0 : _groupAlignments$aGro[bGroupId];\n          if (alignment === alignmentDir) {\n            var _prev$dir;\n            (_prev$dir = prev[dir]) !== null && _prev$dir !== void 0 ? _prev$dir : prev[dir] = [];\n            prev[dir] = [...prev[dir], ...aNodeIds, ...bNodeIds];\n          } else if (aGroupId === \"default\" || bGroupId === \"default\") {\n            var _prev$dir2;\n            (_prev$dir2 = prev[dir]) !== null && _prev$dir2 !== void 0 ? _prev$dir2 : prev[dir] = [];\n            prev[dir] = [...prev[dir], ...aNodeIds, ...bNodeIds];\n          } else {\n            const keyA = \"\".concat(dir, \"-\").concat(cnt++);\n            prev[keyA] = aNodeIds;\n            const keyB = \"\".concat(dir, \"-\").concat(cnt++);\n            prev[keyB] = bNodeIds;\n          }\n        }\n      }\n      return prev;\n    }, {});\n  }, \"flattenAlignments\");\n  const alignments = spatialMaps.map(spatialMap => {\n    const horizontalAlignments = {};\n    const verticalAlignments = {};\n    Object.entries(spatialMap).forEach(_ref9 => {\n      var _db$getNode$in, _db$getNode3, _horizontalAlignments, _horizontalAlignments2, _horizontalAlignments3, _verticalAlignments$x, _verticalAlignments$x2, _verticalAlignments$x3;\n      let [id, [x, y]] = _ref9;\n      const nodeGroup = (_db$getNode$in = (_db$getNode3 = db.getNode(id)) === null || _db$getNode3 === void 0 ? void 0 : _db$getNode3.in) !== null && _db$getNode$in !== void 0 ? _db$getNode$in : \"default\";\n      (_horizontalAlignments = horizontalAlignments[y]) !== null && _horizontalAlignments !== void 0 ? _horizontalAlignments : horizontalAlignments[y] = {};\n      (_horizontalAlignments3 = (_horizontalAlignments2 = horizontalAlignments[y])[nodeGroup]) !== null && _horizontalAlignments3 !== void 0 ? _horizontalAlignments3 : _horizontalAlignments2[nodeGroup] = [];\n      horizontalAlignments[y][nodeGroup].push(id);\n      (_verticalAlignments$x = verticalAlignments[x]) !== null && _verticalAlignments$x !== void 0 ? _verticalAlignments$x : verticalAlignments[x] = {};\n      (_verticalAlignments$x3 = (_verticalAlignments$x2 = verticalAlignments[x])[nodeGroup]) !== null && _verticalAlignments$x3 !== void 0 ? _verticalAlignments$x3 : _verticalAlignments$x2[nodeGroup] = [];\n      verticalAlignments[x][nodeGroup].push(id);\n    });\n    return {\n      horiz: Object.values(flattenAlignments(horizontalAlignments, \"horizontal\")).filter(arr => arr.length > 1),\n      vert: Object.values(flattenAlignments(verticalAlignments, \"vertical\")).filter(arr => arr.length > 1)\n    };\n  });\n  const [horizontal, vertical] = alignments.reduce((_ref0, _ref1) => {\n    let [prevHoriz, prevVert] = _ref0;\n    let {\n      horiz,\n      vert\n    } = _ref1;\n    return [[...prevHoriz, ...horiz], [...prevVert, ...vert]];\n  }, [[], []]);\n  return {\n    horizontal,\n    vertical\n  };\n}\n__name(getAlignments, \"getAlignments\");\nfunction getRelativeConstraints(spatialMaps, db) {\n  const relativeConstraints = [];\n  const posToStr = /* @__PURE__ */__name(pos => \"\".concat(pos[0], \",\").concat(pos[1]), \"posToStr\");\n  const strToPos = /* @__PURE__ */__name(pos => pos.split(\",\").map(p => parseInt(p)), \"strToPos\");\n  spatialMaps.forEach(spatialMap => {\n    const invSpatialMap = Object.fromEntries(Object.entries(spatialMap).map(_ref10 => {\n      let [id, pos] = _ref10;\n      return [posToStr(pos), id];\n    }));\n    const queue = [posToStr([0, 0])];\n    const visited = {};\n    const directions = {\n      L: [-1, 0],\n      R: [1, 0],\n      T: [0, 1],\n      B: [0, -1]\n    };\n    while (queue.length > 0) {\n      const curr = queue.shift();\n      if (curr) {\n        visited[curr] = 1;\n        const currId = invSpatialMap[curr];\n        if (currId) {\n          const currPos = strToPos(curr);\n          Object.entries(directions).forEach(_ref11 => {\n            let [dir, shift] = _ref11;\n            const newPos = posToStr([currPos[0] + shift[0], currPos[1] + shift[1]]);\n            const newId = invSpatialMap[newPos];\n            if (newId && !visited[newPos]) {\n              queue.push(newPos);\n              relativeConstraints.push({\n                [ArchitectureDirectionName[dir]]: newId,\n                [ArchitectureDirectionName[getOppositeArchitectureDirection(dir)]]: currId,\n                gap: 1.5 * db.getConfigField(\"iconSize\")\n              });\n            }\n          });\n        }\n      }\n    }\n  });\n  return relativeConstraints;\n}\n__name(getRelativeConstraints, \"getRelativeConstraints\");\nfunction layoutArchitecture(services, junctions, groups, edges, db, _ref12) {\n  let {\n    spatialMaps,\n    groupAlignments\n  } = _ref12;\n  return new Promise(resolve => {\n    const renderEl = select(\"body\").append(\"div\").attr(\"id\", \"cy\").attr(\"style\", \"display:none\");\n    const cy = cytoscape({\n      container: document.getElementById(\"cy\"),\n      style: [{\n        selector: \"edge\",\n        style: {\n          \"curve-style\": \"straight\",\n          label: \"data(label)\",\n          \"source-endpoint\": \"data(sourceEndpoint)\",\n          \"target-endpoint\": \"data(targetEndpoint)\"\n        }\n      }, {\n        selector: \"edge.segments\",\n        style: {\n          \"curve-style\": \"segments\",\n          \"segment-weights\": \"0\",\n          \"segment-distances\": [0.5],\n          // @ts-ignore Incorrect library types\n          \"edge-distances\": \"endpoints\",\n          \"source-endpoint\": \"data(sourceEndpoint)\",\n          \"target-endpoint\": \"data(targetEndpoint)\"\n        }\n      }, {\n        selector: \"node\",\n        style: {\n          // @ts-ignore Incorrect library types\n          \"compound-sizing-wrt-labels\": \"include\"\n        }\n      }, {\n        selector: \"node[label]\",\n        style: {\n          \"text-valign\": \"bottom\",\n          \"text-halign\": \"center\",\n          \"font-size\": \"\".concat(db.getConfigField(\"fontSize\"), \"px\")\n        }\n      }, {\n        selector: \".node-service\",\n        style: {\n          label: \"data(label)\",\n          width: \"data(width)\",\n          height: \"data(height)\"\n        }\n      }, {\n        selector: \".node-junction\",\n        style: {\n          width: \"data(width)\",\n          height: \"data(height)\"\n        }\n      }, {\n        selector: \".node-group\",\n        style: {\n          // @ts-ignore Incorrect library types\n          padding: \"\".concat(db.getConfigField(\"padding\"), \"px\")\n        }\n      }],\n      layout: {\n        name: \"grid\",\n        boundingBox: {\n          x1: 0,\n          x2: 100,\n          y1: 0,\n          y2: 100\n        }\n      }\n    });\n    renderEl.remove();\n    addGroups(groups, cy);\n    addServices(services, cy, db);\n    addJunctions(junctions, cy, db);\n    addEdges(edges, cy);\n    const alignmentConstraint = getAlignments(db, spatialMaps, groupAlignments);\n    const relativePlacementConstraint = getRelativeConstraints(spatialMaps, db);\n    const layout = cy.layout({\n      name: \"fcose\",\n      quality: \"proof\",\n      styleEnabled: false,\n      animate: false,\n      nodeDimensionsIncludeLabels: false,\n      // Adjust the edge parameters if it passes through the border of a group\n      // Hacky fix for: https://github.com/iVis-at-Bilkent/cytoscape.js-fcose/issues/67\n      idealEdgeLength(edge) {\n        const [nodeA, nodeB] = edge.connectedNodes();\n        const {\n          parent: parentA\n        } = nodeData(nodeA);\n        const {\n          parent: parentB\n        } = nodeData(nodeB);\n        const elasticity = parentA === parentB ? 1.5 * db.getConfigField(\"iconSize\") : 0.5 * db.getConfigField(\"iconSize\");\n        return elasticity;\n      },\n      edgeElasticity(edge) {\n        const [nodeA, nodeB] = edge.connectedNodes();\n        const {\n          parent: parentA\n        } = nodeData(nodeA);\n        const {\n          parent: parentB\n        } = nodeData(nodeB);\n        const elasticity = parentA === parentB ? 0.45 : 1e-3;\n        return elasticity;\n      },\n      alignmentConstraint,\n      relativePlacementConstraint\n    });\n    layout.one(\"layoutstop\", () => {\n      function getSegmentWeights(source, target, pointX, pointY) {\n        let W, D;\n        const {\n          x: sX,\n          y: sY\n        } = source;\n        const {\n          x: tX,\n          y: tY\n        } = target;\n        D = (pointY - sY + (sX - pointX) * (sY - tY) / (sX - tX)) / Math.sqrt(1 + Math.pow((sY - tY) / (sX - tX), 2));\n        W = Math.sqrt(Math.pow(pointY - sY, 2) + Math.pow(pointX - sX, 2) - Math.pow(D, 2));\n        const distAB = Math.sqrt(Math.pow(tX - sX, 2) + Math.pow(tY - sY, 2));\n        W = W / distAB;\n        let delta1 = (tX - sX) * (pointY - sY) - (tY - sY) * (pointX - sX);\n        switch (true) {\n          case delta1 >= 0:\n            delta1 = 1;\n            break;\n          case delta1 < 0:\n            delta1 = -1;\n            break;\n        }\n        let delta2 = (tX - sX) * (pointX - sX) + (tY - sY) * (pointY - sY);\n        switch (true) {\n          case delta2 >= 0:\n            delta2 = 1;\n            break;\n          case delta2 < 0:\n            delta2 = -1;\n            break;\n        }\n        D = Math.abs(D) * delta1;\n        W = W * delta2;\n        return {\n          distances: D,\n          weights: W\n        };\n      }\n      __name(getSegmentWeights, \"getSegmentWeights\");\n      cy.startBatch();\n      for (const edge of Object.values(cy.edges())) {\n        var _edge$data;\n        if ((_edge$data = edge.data) !== null && _edge$data !== void 0 && _edge$data.call(edge)) {\n          const {\n            x: sX,\n            y: sY\n          } = edge.source().position();\n          const {\n            x: tX,\n            y: tY\n          } = edge.target().position();\n          if (sX !== tX && sY !== tY) {\n            const sEP = edge.sourceEndpoint();\n            const tEP = edge.targetEndpoint();\n            const {\n              sourceDir\n            } = edgeData(edge);\n            const [pointX, pointY] = isArchitectureDirectionY(sourceDir) ? [sEP.x, tEP.y] : [tEP.x, sEP.y];\n            const {\n              weights,\n              distances\n            } = getSegmentWeights(sEP, tEP, pointX, pointY);\n            edge.style(\"segment-distances\", distances);\n            edge.style(\"segment-weights\", weights);\n          }\n        }\n      }\n      cy.endBatch();\n      layout.run();\n    });\n    layout.run();\n    cy.ready(e => {\n      log.info(\"Ready\", e);\n      resolve(cy);\n    });\n  });\n}\n__name(layoutArchitecture, \"layoutArchitecture\");\nvar draw = /* @__PURE__ */__name(async (text, id, _version, diagObj) => {\n  const db = diagObj.db;\n  const services = db.getServices();\n  const junctions = db.getJunctions();\n  const groups = db.getGroups();\n  const edges = db.getEdges();\n  const ds = db.getDataStructures();\n  const svg = selectSvgElement(id);\n  const edgesElem = svg.append(\"g\");\n  edgesElem.attr(\"class\", \"architecture-edges\");\n  const servicesElem = svg.append(\"g\");\n  servicesElem.attr(\"class\", \"architecture-services\");\n  const groupElem = svg.append(\"g\");\n  groupElem.attr(\"class\", \"architecture-groups\");\n  await drawServices(db, servicesElem, services);\n  drawJunctions(db, servicesElem, junctions);\n  const cy = await layoutArchitecture(services, junctions, groups, edges, db, ds);\n  await drawEdges(edgesElem, cy, db);\n  await drawGroups(groupElem, cy, db);\n  positionNodes(db, cy);\n  setupGraphViewbox(void 0, svg, db.getConfigField(\"padding\"), db.getConfigField(\"useMaxWidth\"));\n}, \"draw\");\nvar renderer = {\n  draw\n};\n\n// src/diagrams/architecture/architectureDiagram.ts\nvar diagram = {\n  parser,\n  get db() {\n    return new ArchitectureDB();\n  },\n  renderer,\n  styles: architectureStyles_default\n};\nexport { diagram };","map":{"version":3,"names":["selectSvgElement","createText","getIconSVG","registerIconPacks","unknownIcon","populateCommonDb","cleanAndMerge","getEdgeId","clear","defaultConfig_default","getAccDescription","getAccTitle","getConfig","getConfig2","getDiagramTitle","sanitizeText","setAccDescription","setAccTitle","setDiagramTitle","setupGraphViewbox","__name","log","parse","ArchitectureDirectionName","L","R","T","B","ArchitectureDirectionArrow","scale","concat","ArchitectureDirectionArrowShift","orig","arrowSize","_arrowSize","getOppositeArchitectureDirection","x","isArchitectureDirectionX","isArchitectureDirection","temp","isArchitectureDirectionY","isArchitectureDirectionXY","a","b","aX_bY","aY_bX","isArchitecturePairXY","pair","lhs","rhs","isValidArchitectureDirectionPair","getArchitectureDirectionPair","sourceDir","targetDir","shiftPositionByArchitectureDirectionPair","_ref","y","getArchitectureDirectionXYFactors","getArchitectureDirectionAlignment","isArchitectureService","type","isArchitectureJunction","edgeData","edge","data","nodeData","node","DEFAULT_ARCHITECTURE_CONFIG","architecture","ArchitectureDB","_Class","constructor","nodes","groups","edges","registeredIds","elements","dataStructures","addService","_ref2","id","icon","in","parent","title","iconText","Error","getServices","Object","values","filter","addJunction","_ref3","getJunctions","getNodes","getNode","_this$nodes$id","addGroup","_ref4","_this$registeredIds","_this$registeredIds2","_this$registeredIds3","getGroups","addEdge","_ref5","lhsId","rhsId","lhsDir","rhsDir","lhsInto","rhsInto","lhsGroup","rhsGroup","String","lhsGroupId","rhsGroupId","push","length","getEdges","getDataStructures","groupAlignments","adjList","entries","reduce","prevOuter","_ref6","service","prevInner","_this$getNode","_this$getNode2","alignment","_groupAlignments$lhsG","_groupAlignments$rhsG","firstId","keys","visited","notVisited","prev","_objectSpread","BFS","startingId","spatialMap","queue","shift","adj","posX","posY","forEach","_ref7","dir","spatialMaps","setElementForId","element","getElementById","getConfigField","field","populateDb","ast","db","map","group","services","junctions","parser","yy","input","_parser$parser","debug","getStyles","options","archEdgeWidth","archEdgeColor","archEdgeArrowColor","archGroupBorderColor","archGroupBorderWidth","architectureStyles_default","cytoscape","fcose","select","wrapIcon","architectureIcons","prefix","height","width","icons","database","body","server","disk","internet","cloud","unknown","blank","drawEdges","edgesEl","cy","padding","iconSize","halfIconSize","halfArrowSize","Promise","all","_db$getNode","_db$getNode2","source","sourceArrow","sourceGroup","target","targetArrow","targetGroup","label","startX","startY","sourceEndpoint","midX","midY","midpoint","endX","endY","targetEndpoint","groupEdgeShift","_private","rscratch","g","insert","attr","xShift","yShift","axis","Math","abs","textElem","append","useHtmlLabels","classes","bboxOrig","getBoundingClientRect","bboxNew","drawGroups","groupsEl","groupIconSize","fontSize","h","w","x1","y1","boundingBox","groupsNode","groupLabelContainer","shiftedX1","shiftedY1","bkgElem","html","fallbackPrefix","drawServices","elem","config","serviceElem","_parseInt","textElemContainer","fo","divElem","parseInt","window","getComputedStyle","getPropertyValue","replace","floor","getBBox","drawJunctions","junction","junctionElem","_groups","name","use","addServices","add","addJunctions","positionNodes","position","nodeElem","addGroups","addEdges","parsedEdge","edgeType","getAlignments","flattenAlignments","alignmentObj","alignmentDir","_ref8","alignments2","cnt","arr","i","j","_groupAlignments$aGro","aGroupId","aNodeIds","bGroupId","bNodeIds","_prev$dir","_prev$dir2","keyA","keyB","alignments","horizontalAlignments","verticalAlignments","_ref9","_db$getNode$in","_db$getNode3","_horizontalAlignments","_horizontalAlignments2","_horizontalAlignments3","_verticalAlignments$x","_verticalAlignments$x2","_verticalAlignments$x3","nodeGroup","horiz","vert","horizontal","vertical","_ref0","_ref1","prevHoriz","prevVert","getRelativeConstraints","relativeConstraints","posToStr","pos","strToPos","split","p","invSpatialMap","fromEntries","_ref10","directions","curr","currId","currPos","_ref11","newPos","newId","gap","layoutArchitecture","_ref12","resolve","renderEl","container","document","style","selector","layout","x2","y2","remove","alignmentConstraint","relativePlacementConstraint","quality","styleEnabled","animate","nodeDimensionsIncludeLabels","idealEdgeLength","nodeA","nodeB","connectedNodes","parentA","parentB","elasticity","edgeElasticity","one","getSegmentWeights","pointX","pointY","W","D","sX","sY","tX","tY","sqrt","pow","distAB","delta1","delta2","distances","weights","startBatch","_edge$data","call","sEP","tEP","endBatch","run","ready","e","info","draw","text","_version","diagObj","ds","svg","edgesElem","servicesElem","groupElem","renderer","diagram","styles"],"sources":["/home/saiadmin/k3s-cluster/dashboard/frontend/node_modules/mermaid/dist/chunks/mermaid.core/architectureDiagram-VXUJARFQ.mjs"],"sourcesContent":["import {\n  selectSvgElement\n} from \"./chunk-EXTU4WIE.mjs\";\nimport {\n  createText,\n  getIconSVG,\n  registerIconPacks,\n  unknownIcon\n} from \"./chunk-JA3XYJ7Z.mjs\";\nimport {\n  populateCommonDb\n} from \"./chunk-4BX2VUAB.mjs\";\nimport {\n  cleanAndMerge,\n  getEdgeId\n} from \"./chunk-S3R3BYOJ.mjs\";\nimport {\n  clear,\n  defaultConfig_default,\n  getAccDescription,\n  getAccTitle,\n  getConfig,\n  getConfig2,\n  getDiagramTitle,\n  sanitizeText,\n  setAccDescription,\n  setAccTitle,\n  setDiagramTitle,\n  setupGraphViewbox\n} from \"./chunk-ABZYJK2D.mjs\";\nimport {\n  __name,\n  log\n} from \"./chunk-AGHRB4JF.mjs\";\n\n// src/diagrams/architecture/architectureParser.ts\nimport { parse } from \"@mermaid-js/parser\";\n\n// src/diagrams/architecture/architectureTypes.ts\nvar ArchitectureDirectionName = {\n  L: \"left\",\n  R: \"right\",\n  T: \"top\",\n  B: \"bottom\"\n};\nvar ArchitectureDirectionArrow = {\n  L: /* @__PURE__ */ __name((scale) => `${scale},${scale / 2} 0,${scale} 0,0`, \"L\"),\n  R: /* @__PURE__ */ __name((scale) => `0,${scale / 2} ${scale},0 ${scale},${scale}`, \"R\"),\n  T: /* @__PURE__ */ __name((scale) => `0,0 ${scale},0 ${scale / 2},${scale}`, \"T\"),\n  B: /* @__PURE__ */ __name((scale) => `${scale / 2},0 ${scale},${scale} 0,${scale}`, \"B\")\n};\nvar ArchitectureDirectionArrowShift = {\n  L: /* @__PURE__ */ __name((orig, arrowSize) => orig - arrowSize + 2, \"L\"),\n  R: /* @__PURE__ */ __name((orig, _arrowSize) => orig - 2, \"R\"),\n  T: /* @__PURE__ */ __name((orig, arrowSize) => orig - arrowSize + 2, \"T\"),\n  B: /* @__PURE__ */ __name((orig, _arrowSize) => orig - 2, \"B\")\n};\nvar getOppositeArchitectureDirection = /* @__PURE__ */ __name(function(x) {\n  if (isArchitectureDirectionX(x)) {\n    return x === \"L\" ? \"R\" : \"L\";\n  } else {\n    return x === \"T\" ? \"B\" : \"T\";\n  }\n}, \"getOppositeArchitectureDirection\");\nvar isArchitectureDirection = /* @__PURE__ */ __name(function(x) {\n  const temp = x;\n  return temp === \"L\" || temp === \"R\" || temp === \"T\" || temp === \"B\";\n}, \"isArchitectureDirection\");\nvar isArchitectureDirectionX = /* @__PURE__ */ __name(function(x) {\n  const temp = x;\n  return temp === \"L\" || temp === \"R\";\n}, \"isArchitectureDirectionX\");\nvar isArchitectureDirectionY = /* @__PURE__ */ __name(function(x) {\n  const temp = x;\n  return temp === \"T\" || temp === \"B\";\n}, \"isArchitectureDirectionY\");\nvar isArchitectureDirectionXY = /* @__PURE__ */ __name(function(a, b) {\n  const aX_bY = isArchitectureDirectionX(a) && isArchitectureDirectionY(b);\n  const aY_bX = isArchitectureDirectionY(a) && isArchitectureDirectionX(b);\n  return aX_bY || aY_bX;\n}, \"isArchitectureDirectionXY\");\nvar isArchitecturePairXY = /* @__PURE__ */ __name(function(pair) {\n  const lhs = pair[0];\n  const rhs = pair[1];\n  const aX_bY = isArchitectureDirectionX(lhs) && isArchitectureDirectionY(rhs);\n  const aY_bX = isArchitectureDirectionY(lhs) && isArchitectureDirectionX(rhs);\n  return aX_bY || aY_bX;\n}, \"isArchitecturePairXY\");\nvar isValidArchitectureDirectionPair = /* @__PURE__ */ __name(function(x) {\n  return x !== \"LL\" && x !== \"RR\" && x !== \"TT\" && x !== \"BB\";\n}, \"isValidArchitectureDirectionPair\");\nvar getArchitectureDirectionPair = /* @__PURE__ */ __name(function(sourceDir, targetDir) {\n  const pair = `${sourceDir}${targetDir}`;\n  return isValidArchitectureDirectionPair(pair) ? pair : void 0;\n}, \"getArchitectureDirectionPair\");\nvar shiftPositionByArchitectureDirectionPair = /* @__PURE__ */ __name(function([x, y], pair) {\n  const lhs = pair[0];\n  const rhs = pair[1];\n  if (isArchitectureDirectionX(lhs)) {\n    if (isArchitectureDirectionY(rhs)) {\n      return [x + (lhs === \"L\" ? -1 : 1), y + (rhs === \"T\" ? 1 : -1)];\n    } else {\n      return [x + (lhs === \"L\" ? -1 : 1), y];\n    }\n  } else {\n    if (isArchitectureDirectionX(rhs)) {\n      return [x + (rhs === \"L\" ? 1 : -1), y + (lhs === \"T\" ? 1 : -1)];\n    } else {\n      return [x, y + (lhs === \"T\" ? 1 : -1)];\n    }\n  }\n}, \"shiftPositionByArchitectureDirectionPair\");\nvar getArchitectureDirectionXYFactors = /* @__PURE__ */ __name(function(pair) {\n  if (pair === \"LT\" || pair === \"TL\") {\n    return [1, 1];\n  } else if (pair === \"BL\" || pair === \"LB\") {\n    return [1, -1];\n  } else if (pair === \"BR\" || pair === \"RB\") {\n    return [-1, -1];\n  } else {\n    return [-1, 1];\n  }\n}, \"getArchitectureDirectionXYFactors\");\nvar getArchitectureDirectionAlignment = /* @__PURE__ */ __name(function(a, b) {\n  if (isArchitectureDirectionXY(a, b)) {\n    return \"bend\";\n  } else if (isArchitectureDirectionX(a)) {\n    return \"horizontal\";\n  }\n  return \"vertical\";\n}, \"getArchitectureDirectionAlignment\");\nvar isArchitectureService = /* @__PURE__ */ __name(function(x) {\n  const temp = x;\n  return temp.type === \"service\";\n}, \"isArchitectureService\");\nvar isArchitectureJunction = /* @__PURE__ */ __name(function(x) {\n  const temp = x;\n  return temp.type === \"junction\";\n}, \"isArchitectureJunction\");\nvar edgeData = /* @__PURE__ */ __name((edge) => {\n  return edge.data();\n}, \"edgeData\");\nvar nodeData = /* @__PURE__ */ __name((node) => {\n  return node.data();\n}, \"nodeData\");\n\n// src/diagrams/architecture/architectureDb.ts\nvar DEFAULT_ARCHITECTURE_CONFIG = defaultConfig_default.architecture;\nvar ArchitectureDB = class {\n  constructor() {\n    this.nodes = {};\n    this.groups = {};\n    this.edges = [];\n    this.registeredIds = {};\n    this.elements = {};\n    this.setAccTitle = setAccTitle;\n    this.getAccTitle = getAccTitle;\n    this.setDiagramTitle = setDiagramTitle;\n    this.getDiagramTitle = getDiagramTitle;\n    this.getAccDescription = getAccDescription;\n    this.setAccDescription = setAccDescription;\n    this.clear();\n  }\n  static {\n    __name(this, \"ArchitectureDB\");\n  }\n  clear() {\n    this.nodes = {};\n    this.groups = {};\n    this.edges = [];\n    this.registeredIds = {};\n    this.dataStructures = void 0;\n    this.elements = {};\n    clear();\n  }\n  addService({\n    id,\n    icon,\n    in: parent,\n    title,\n    iconText\n  }) {\n    if (this.registeredIds[id] !== void 0) {\n      throw new Error(\n        `The service id [${id}] is already in use by another ${this.registeredIds[id]}`\n      );\n    }\n    if (parent !== void 0) {\n      if (id === parent) {\n        throw new Error(`The service [${id}] cannot be placed within itself`);\n      }\n      if (this.registeredIds[parent] === void 0) {\n        throw new Error(\n          `The service [${id}]'s parent does not exist. Please make sure the parent is created before this service`\n        );\n      }\n      if (this.registeredIds[parent] === \"node\") {\n        throw new Error(`The service [${id}]'s parent is not a group`);\n      }\n    }\n    this.registeredIds[id] = \"node\";\n    this.nodes[id] = {\n      id,\n      type: \"service\",\n      icon,\n      iconText,\n      title,\n      edges: [],\n      in: parent\n    };\n  }\n  getServices() {\n    return Object.values(this.nodes).filter(isArchitectureService);\n  }\n  addJunction({ id, in: parent }) {\n    this.registeredIds[id] = \"node\";\n    this.nodes[id] = {\n      id,\n      type: \"junction\",\n      edges: [],\n      in: parent\n    };\n  }\n  getJunctions() {\n    return Object.values(this.nodes).filter(isArchitectureJunction);\n  }\n  getNodes() {\n    return Object.values(this.nodes);\n  }\n  getNode(id) {\n    return this.nodes[id] ?? null;\n  }\n  addGroup({ id, icon, in: parent, title }) {\n    if (this.registeredIds?.[id] !== void 0) {\n      throw new Error(\n        `The group id [${id}] is already in use by another ${this.registeredIds[id]}`\n      );\n    }\n    if (parent !== void 0) {\n      if (id === parent) {\n        throw new Error(`The group [${id}] cannot be placed within itself`);\n      }\n      if (this.registeredIds?.[parent] === void 0) {\n        throw new Error(\n          `The group [${id}]'s parent does not exist. Please make sure the parent is created before this group`\n        );\n      }\n      if (this.registeredIds?.[parent] === \"node\") {\n        throw new Error(`The group [${id}]'s parent is not a group`);\n      }\n    }\n    this.registeredIds[id] = \"group\";\n    this.groups[id] = {\n      id,\n      icon,\n      title,\n      in: parent\n    };\n  }\n  getGroups() {\n    return Object.values(this.groups);\n  }\n  addEdge({\n    lhsId,\n    rhsId,\n    lhsDir,\n    rhsDir,\n    lhsInto,\n    rhsInto,\n    lhsGroup,\n    rhsGroup,\n    title\n  }) {\n    if (!isArchitectureDirection(lhsDir)) {\n      throw new Error(\n        `Invalid direction given for left hand side of edge ${lhsId}--${rhsId}. Expected (L,R,T,B) got ${String(lhsDir)}`\n      );\n    }\n    if (!isArchitectureDirection(rhsDir)) {\n      throw new Error(\n        `Invalid direction given for right hand side of edge ${lhsId}--${rhsId}. Expected (L,R,T,B) got ${String(rhsDir)}`\n      );\n    }\n    if (this.nodes[lhsId] === void 0 && this.groups[lhsId] === void 0) {\n      throw new Error(\n        `The left-hand id [${lhsId}] does not yet exist. Please create the service/group before declaring an edge to it.`\n      );\n    }\n    if (this.nodes[rhsId] === void 0 && this.groups[rhsId] === void 0) {\n      throw new Error(\n        `The right-hand id [${rhsId}] does not yet exist. Please create the service/group before declaring an edge to it.`\n      );\n    }\n    const lhsGroupId = this.nodes[lhsId].in;\n    const rhsGroupId = this.nodes[rhsId].in;\n    if (lhsGroup && lhsGroupId && rhsGroupId && lhsGroupId == rhsGroupId) {\n      throw new Error(\n        `The left-hand id [${lhsId}] is modified to traverse the group boundary, but the edge does not pass through two groups.`\n      );\n    }\n    if (rhsGroup && lhsGroupId && rhsGroupId && lhsGroupId == rhsGroupId) {\n      throw new Error(\n        `The right-hand id [${rhsId}] is modified to traverse the group boundary, but the edge does not pass through two groups.`\n      );\n    }\n    const edge = {\n      lhsId,\n      lhsDir,\n      lhsInto,\n      lhsGroup,\n      rhsId,\n      rhsDir,\n      rhsInto,\n      rhsGroup,\n      title\n    };\n    this.edges.push(edge);\n    if (this.nodes[lhsId] && this.nodes[rhsId]) {\n      this.nodes[lhsId].edges.push(this.edges[this.edges.length - 1]);\n      this.nodes[rhsId].edges.push(this.edges[this.edges.length - 1]);\n    }\n  }\n  getEdges() {\n    return this.edges;\n  }\n  /**\n   * Returns the current diagram's adjacency list, spatial map, & group alignments.\n   * If they have not been created, run the algorithms to generate them.\n   * @returns\n   */\n  getDataStructures() {\n    if (this.dataStructures === void 0) {\n      const groupAlignments = {};\n      const adjList = Object.entries(this.nodes).reduce((prevOuter, [id, service]) => {\n        prevOuter[id] = service.edges.reduce((prevInner, edge) => {\n          const lhsGroupId = this.getNode(edge.lhsId)?.in;\n          const rhsGroupId = this.getNode(edge.rhsId)?.in;\n          if (lhsGroupId && rhsGroupId && lhsGroupId !== rhsGroupId) {\n            const alignment = getArchitectureDirectionAlignment(edge.lhsDir, edge.rhsDir);\n            if (alignment !== \"bend\") {\n              groupAlignments[lhsGroupId] ??= {};\n              groupAlignments[lhsGroupId][rhsGroupId] = alignment;\n              groupAlignments[rhsGroupId] ??= {};\n              groupAlignments[rhsGroupId][lhsGroupId] = alignment;\n            }\n          }\n          if (edge.lhsId === id) {\n            const pair = getArchitectureDirectionPair(edge.lhsDir, edge.rhsDir);\n            if (pair) {\n              prevInner[pair] = edge.rhsId;\n            }\n          } else {\n            const pair = getArchitectureDirectionPair(edge.rhsDir, edge.lhsDir);\n            if (pair) {\n              prevInner[pair] = edge.lhsId;\n            }\n          }\n          return prevInner;\n        }, {});\n        return prevOuter;\n      }, {});\n      const firstId = Object.keys(adjList)[0];\n      const visited = { [firstId]: 1 };\n      const notVisited = Object.keys(adjList).reduce(\n        (prev, id) => id === firstId ? prev : { ...prev, [id]: 1 },\n        {}\n      );\n      const BFS = /* @__PURE__ */ __name((startingId) => {\n        const spatialMap = { [startingId]: [0, 0] };\n        const queue = [startingId];\n        while (queue.length > 0) {\n          const id = queue.shift();\n          if (id) {\n            visited[id] = 1;\n            delete notVisited[id];\n            const adj = adjList[id];\n            const [posX, posY] = spatialMap[id];\n            Object.entries(adj).forEach(([dir, rhsId]) => {\n              if (!visited[rhsId]) {\n                spatialMap[rhsId] = shiftPositionByArchitectureDirectionPair(\n                  [posX, posY],\n                  dir\n                );\n                queue.push(rhsId);\n              }\n            });\n          }\n        }\n        return spatialMap;\n      }, \"BFS\");\n      const spatialMaps = [BFS(firstId)];\n      while (Object.keys(notVisited).length > 0) {\n        spatialMaps.push(BFS(Object.keys(notVisited)[0]));\n      }\n      this.dataStructures = {\n        adjList,\n        spatialMaps,\n        groupAlignments\n      };\n    }\n    return this.dataStructures;\n  }\n  setElementForId(id, element) {\n    this.elements[id] = element;\n  }\n  getElementById(id) {\n    return this.elements[id];\n  }\n  getConfig() {\n    return cleanAndMerge({\n      ...DEFAULT_ARCHITECTURE_CONFIG,\n      ...getConfig().architecture\n    });\n  }\n  getConfigField(field) {\n    return this.getConfig()[field];\n  }\n};\n\n// src/diagrams/architecture/architectureParser.ts\nvar populateDb = /* @__PURE__ */ __name((ast, db) => {\n  populateCommonDb(ast, db);\n  ast.groups.map((group) => db.addGroup(group));\n  ast.services.map((service) => db.addService({ ...service, type: \"service\" }));\n  ast.junctions.map((service) => db.addJunction({ ...service, type: \"junction\" }));\n  ast.edges.map((edge) => db.addEdge(edge));\n}, \"populateDb\");\nvar parser = {\n  parser: {\n    // @ts-expect-error - ArchitectureDB is not assignable to DiagramDB\n    yy: void 0\n  },\n  parse: /* @__PURE__ */ __name(async (input) => {\n    const ast = await parse(\"architecture\", input);\n    log.debug(ast);\n    const db = parser.parser?.yy;\n    if (!(db instanceof ArchitectureDB)) {\n      throw new Error(\n        \"parser.parser?.yy was not a ArchitectureDB. This is due to a bug within Mermaid, please report this issue at https://github.com/mermaid-js/mermaid/issues.\"\n      );\n    }\n    populateDb(ast, db);\n  }, \"parse\")\n};\n\n// src/diagrams/architecture/architectureStyles.ts\nvar getStyles = /* @__PURE__ */ __name((options) => `\n  .edge {\n    stroke-width: ${options.archEdgeWidth};\n    stroke: ${options.archEdgeColor};\n    fill: none;\n  }\n\n  .arrow {\n    fill: ${options.archEdgeArrowColor};\n  }\n\n  .node-bkg {\n    fill: none;\n    stroke: ${options.archGroupBorderColor};\n    stroke-width: ${options.archGroupBorderWidth};\n    stroke-dasharray: 8;\n  }\n  .node-icon-text {\n    display: flex; \n    align-items: center;\n  }\n  \n  .node-icon-text > div {\n    color: #fff;\n    margin: 1px;\n    height: fit-content;\n    text-align: center;\n    overflow: hidden;\n    display: -webkit-box;\n    -webkit-box-orient: vertical;\n  }\n`, \"getStyles\");\nvar architectureStyles_default = getStyles;\n\n// src/diagrams/architecture/architectureRenderer.ts\nimport cytoscape from \"cytoscape\";\nimport fcose from \"cytoscape-fcose\";\nimport { select } from \"d3\";\n\n// src/diagrams/architecture/architectureIcons.ts\nvar wrapIcon = /* @__PURE__ */ __name((icon) => {\n  return `<g><rect width=\"80\" height=\"80\" style=\"fill: #087ebf; stroke-width: 0px;\"/>${icon}</g>`;\n}, \"wrapIcon\");\nvar architectureIcons = {\n  prefix: \"mermaid-architecture\",\n  height: 80,\n  width: 80,\n  icons: {\n    database: {\n      body: wrapIcon(\n        '<path id=\"b\" data-name=\"4\" d=\"m20,57.86c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path id=\"c\" data-name=\"3\" d=\"m20,45.95c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path id=\"d\" data-name=\"2\" d=\"m20,34.05c0,3.94,8.95,7.14,20,7.14s20-3.2,20-7.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse id=\"e\" data-name=\"1\" cx=\"40\" cy=\"22.14\" rx=\"20\" ry=\"7.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"20\" y1=\"57.86\" x2=\"20\" y2=\"22.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"60\" y1=\"57.86\" x2=\"60\" y2=\"22.14\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/>'\n      )\n    },\n    server: {\n      body: wrapIcon(\n        '<rect x=\"17.5\" y=\"17.5\" width=\"45\" height=\"45\" rx=\"2\" ry=\"2\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"17.5\" y1=\"32.5\" x2=\"62.5\" y2=\"32.5\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"17.5\" y1=\"47.5\" x2=\"62.5\" y2=\"47.5\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><g><path d=\"m56.25,25c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: #fff; stroke-width: 0px;\"/><path d=\"m56.25,25c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><path d=\"m56.25,40c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: #fff; stroke-width: 0px;\"/><path d=\"m56.25,40c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><path d=\"m56.25,55c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: #fff; stroke-width: 0px;\"/><path d=\"m56.25,55c0,.27-.45.5-1,.5h-10.5c-.55,0-1-.23-1-.5s.45-.5,1-.5h10.5c.55,0,1,.23,1,.5Z\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><circle cx=\"32.5\" cy=\"25\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"27.5\" cy=\"25\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"22.5\" cy=\"25\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><circle cx=\"32.5\" cy=\"40\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"27.5\" cy=\"40\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"22.5\" cy=\"40\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/></g><g><circle cx=\"32.5\" cy=\"55\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"27.5\" cy=\"55\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/><circle cx=\"22.5\" cy=\"55\" r=\".75\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10;\"/></g>'\n      )\n    },\n    disk: {\n      body: wrapIcon(\n        '<rect x=\"20\" y=\"15\" width=\"40\" height=\"50\" rx=\"1\" ry=\"1\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"24\" cy=\"19.17\" rx=\".8\" ry=\".83\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"56\" cy=\"19.17\" rx=\".8\" ry=\".83\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"24\" cy=\"60.83\" rx=\".8\" ry=\".83\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"56\" cy=\"60.83\" rx=\".8\" ry=\".83\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"40\" cy=\"33.75\" rx=\"14\" ry=\"14.58\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><ellipse cx=\"40\" cy=\"33.75\" rx=\"4\" ry=\"4.17\" style=\"fill: #fff; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path d=\"m37.51,42.52l-4.83,13.22c-.26.71-1.1,1.02-1.76.64l-4.18-2.42c-.66-.38-.81-1.26-.33-1.84l9.01-10.8c.88-1.05,2.56-.08,2.09,1.2Z\" style=\"fill: #fff; stroke-width: 0px;\"/>'\n      )\n    },\n    internet: {\n      body: wrapIcon(\n        '<circle cx=\"40\" cy=\"40\" r=\"22.5\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"40\" y1=\"17.5\" x2=\"40\" y2=\"62.5\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"17.5\" y1=\"40\" x2=\"62.5\" y2=\"40\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path d=\"m39.99,17.51c-15.28,11.1-15.28,33.88,0,44.98\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><path d=\"m40.01,17.51c15.28,11.1,15.28,33.88,0,44.98\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"19.75\" y1=\"30.1\" x2=\"60.25\" y2=\"30.1\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/><line x1=\"19.75\" y1=\"49.9\" x2=\"60.25\" y2=\"49.9\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/>'\n      )\n    },\n    cloud: {\n      body: wrapIcon(\n        '<path d=\"m65,47.5c0,2.76-2.24,5-5,5H20c-2.76,0-5-2.24-5-5,0-1.87,1.03-3.51,2.56-4.36-.04-.21-.06-.42-.06-.64,0-2.6,2.48-4.74,5.65-4.97,1.65-4.51,6.34-7.76,11.85-7.76.86,0,1.69.08,2.5.23,2.09-1.57,4.69-2.5,7.5-2.5,6.1,0,11.19,4.38,12.28,10.17,2.14.56,3.72,2.51,3.72,4.83,0,.03,0,.07-.01.1,2.29.46,4.01,2.48,4.01,4.9Z\" style=\"fill: none; stroke: #fff; stroke-miterlimit: 10; stroke-width: 2px;\"/>'\n      )\n    },\n    unknown: unknownIcon,\n    blank: {\n      body: wrapIcon(\"\")\n    }\n  }\n};\n\n// src/diagrams/architecture/svgDraw.ts\nvar drawEdges = /* @__PURE__ */ __name(async function(edgesEl, cy, db) {\n  const padding = db.getConfigField(\"padding\");\n  const iconSize = db.getConfigField(\"iconSize\");\n  const halfIconSize = iconSize / 2;\n  const arrowSize = iconSize / 6;\n  const halfArrowSize = arrowSize / 2;\n  await Promise.all(\n    cy.edges().map(async (edge) => {\n      const {\n        source,\n        sourceDir,\n        sourceArrow,\n        sourceGroup,\n        target,\n        targetDir,\n        targetArrow,\n        targetGroup,\n        label\n      } = edgeData(edge);\n      let { x: startX, y: startY } = edge[0].sourceEndpoint();\n      const { x: midX, y: midY } = edge[0].midpoint();\n      let { x: endX, y: endY } = edge[0].targetEndpoint();\n      const groupEdgeShift = padding + 4;\n      if (sourceGroup) {\n        if (isArchitectureDirectionX(sourceDir)) {\n          startX += sourceDir === \"L\" ? -groupEdgeShift : groupEdgeShift;\n        } else {\n          startY += sourceDir === \"T\" ? -groupEdgeShift : groupEdgeShift + 18;\n        }\n      }\n      if (targetGroup) {\n        if (isArchitectureDirectionX(targetDir)) {\n          endX += targetDir === \"L\" ? -groupEdgeShift : groupEdgeShift;\n        } else {\n          endY += targetDir === \"T\" ? -groupEdgeShift : groupEdgeShift + 18;\n        }\n      }\n      if (!sourceGroup && db.getNode(source)?.type === \"junction\") {\n        if (isArchitectureDirectionX(sourceDir)) {\n          startX += sourceDir === \"L\" ? halfIconSize : -halfIconSize;\n        } else {\n          startY += sourceDir === \"T\" ? halfIconSize : -halfIconSize;\n        }\n      }\n      if (!targetGroup && db.getNode(target)?.type === \"junction\") {\n        if (isArchitectureDirectionX(targetDir)) {\n          endX += targetDir === \"L\" ? halfIconSize : -halfIconSize;\n        } else {\n          endY += targetDir === \"T\" ? halfIconSize : -halfIconSize;\n        }\n      }\n      if (edge[0]._private.rscratch) {\n        const g = edgesEl.insert(\"g\");\n        g.insert(\"path\").attr(\"d\", `M ${startX},${startY} L ${midX},${midY} L${endX},${endY} `).attr(\"class\", \"edge\").attr(\"id\", getEdgeId(source, target, { prefix: \"L\" }));\n        if (sourceArrow) {\n          const xShift = isArchitectureDirectionX(sourceDir) ? ArchitectureDirectionArrowShift[sourceDir](startX, arrowSize) : startX - halfArrowSize;\n          const yShift = isArchitectureDirectionY(sourceDir) ? ArchitectureDirectionArrowShift[sourceDir](startY, arrowSize) : startY - halfArrowSize;\n          g.insert(\"polygon\").attr(\"points\", ArchitectureDirectionArrow[sourceDir](arrowSize)).attr(\"transform\", `translate(${xShift},${yShift})`).attr(\"class\", \"arrow\");\n        }\n        if (targetArrow) {\n          const xShift = isArchitectureDirectionX(targetDir) ? ArchitectureDirectionArrowShift[targetDir](endX, arrowSize) : endX - halfArrowSize;\n          const yShift = isArchitectureDirectionY(targetDir) ? ArchitectureDirectionArrowShift[targetDir](endY, arrowSize) : endY - halfArrowSize;\n          g.insert(\"polygon\").attr(\"points\", ArchitectureDirectionArrow[targetDir](arrowSize)).attr(\"transform\", `translate(${xShift},${yShift})`).attr(\"class\", \"arrow\");\n        }\n        if (label) {\n          const axis = !isArchitectureDirectionXY(sourceDir, targetDir) ? isArchitectureDirectionX(sourceDir) ? \"X\" : \"Y\" : \"XY\";\n          let width = 0;\n          if (axis === \"X\") {\n            width = Math.abs(startX - endX);\n          } else if (axis === \"Y\") {\n            width = Math.abs(startY - endY) / 1.5;\n          } else {\n            width = Math.abs(startX - endX) / 2;\n          }\n          const textElem = g.append(\"g\");\n          await createText(\n            textElem,\n            label,\n            {\n              useHtmlLabels: false,\n              width,\n              classes: \"architecture-service-label\"\n            },\n            getConfig2()\n          );\n          textElem.attr(\"dy\", \"1em\").attr(\"alignment-baseline\", \"middle\").attr(\"dominant-baseline\", \"middle\").attr(\"text-anchor\", \"middle\");\n          if (axis === \"X\") {\n            textElem.attr(\"transform\", \"translate(\" + midX + \", \" + midY + \")\");\n          } else if (axis === \"Y\") {\n            textElem.attr(\"transform\", \"translate(\" + midX + \", \" + midY + \") rotate(-90)\");\n          } else if (axis === \"XY\") {\n            const pair = getArchitectureDirectionPair(sourceDir, targetDir);\n            if (pair && isArchitecturePairXY(pair)) {\n              const bboxOrig = textElem.node().getBoundingClientRect();\n              const [x, y] = getArchitectureDirectionXYFactors(pair);\n              textElem.attr(\"dominant-baseline\", \"auto\").attr(\"transform\", `rotate(${-1 * x * y * 45})`);\n              const bboxNew = textElem.node().getBoundingClientRect();\n              textElem.attr(\n                \"transform\",\n                `\n                translate(${midX}, ${midY - bboxOrig.height / 2})\n                translate(${x * bboxNew.width / 2}, ${y * bboxNew.height / 2})\n                rotate(${-1 * x * y * 45}, 0, ${bboxOrig.height / 2})\n              `\n              );\n            }\n          }\n        }\n      }\n    })\n  );\n}, \"drawEdges\");\nvar drawGroups = /* @__PURE__ */ __name(async function(groupsEl, cy, db) {\n  const padding = db.getConfigField(\"padding\");\n  const groupIconSize = padding * 0.75;\n  const fontSize = db.getConfigField(\"fontSize\");\n  const iconSize = db.getConfigField(\"iconSize\");\n  const halfIconSize = iconSize / 2;\n  await Promise.all(\n    cy.nodes().map(async (node) => {\n      const data = nodeData(node);\n      if (data.type === \"group\") {\n        const { h, w, x1, y1 } = node.boundingBox();\n        const groupsNode = groupsEl.append(\"rect\");\n        groupsNode.attr(\"id\", `group-${data.id}`).attr(\"x\", x1 + halfIconSize).attr(\"y\", y1 + halfIconSize).attr(\"width\", w).attr(\"height\", h).attr(\"class\", \"node-bkg\");\n        const groupLabelContainer = groupsEl.append(\"g\");\n        let shiftedX1 = x1;\n        let shiftedY1 = y1;\n        if (data.icon) {\n          const bkgElem = groupLabelContainer.append(\"g\");\n          bkgElem.html(\n            `<g>${await getIconSVG(data.icon, { height: groupIconSize, width: groupIconSize, fallbackPrefix: architectureIcons.prefix })}</g>`\n          );\n          bkgElem.attr(\n            \"transform\",\n            \"translate(\" + (shiftedX1 + halfIconSize + 1) + \", \" + (shiftedY1 + halfIconSize + 1) + \")\"\n          );\n          shiftedX1 += groupIconSize;\n          shiftedY1 += fontSize / 2 - 1 - 2;\n        }\n        if (data.label) {\n          const textElem = groupLabelContainer.append(\"g\");\n          await createText(\n            textElem,\n            data.label,\n            {\n              useHtmlLabels: false,\n              width: w,\n              classes: \"architecture-service-label\"\n            },\n            getConfig2()\n          );\n          textElem.attr(\"dy\", \"1em\").attr(\"alignment-baseline\", \"middle\").attr(\"dominant-baseline\", \"start\").attr(\"text-anchor\", \"start\");\n          textElem.attr(\n            \"transform\",\n            \"translate(\" + (shiftedX1 + halfIconSize + 4) + \", \" + (shiftedY1 + halfIconSize + 2) + \")\"\n          );\n        }\n        db.setElementForId(data.id, groupsNode);\n      }\n    })\n  );\n}, \"drawGroups\");\nvar drawServices = /* @__PURE__ */ __name(async function(db, elem, services) {\n  const config = getConfig2();\n  for (const service of services) {\n    const serviceElem = elem.append(\"g\");\n    const iconSize = db.getConfigField(\"iconSize\");\n    if (service.title) {\n      const textElem = serviceElem.append(\"g\");\n      await createText(\n        textElem,\n        service.title,\n        {\n          useHtmlLabels: false,\n          width: iconSize * 1.5,\n          classes: \"architecture-service-label\"\n        },\n        config\n      );\n      textElem.attr(\"dy\", \"1em\").attr(\"alignment-baseline\", \"middle\").attr(\"dominant-baseline\", \"middle\").attr(\"text-anchor\", \"middle\");\n      textElem.attr(\"transform\", \"translate(\" + iconSize / 2 + \", \" + iconSize + \")\");\n    }\n    const bkgElem = serviceElem.append(\"g\");\n    if (service.icon) {\n      bkgElem.html(\n        `<g>${await getIconSVG(service.icon, { height: iconSize, width: iconSize, fallbackPrefix: architectureIcons.prefix })}</g>`\n      );\n    } else if (service.iconText) {\n      bkgElem.html(\n        `<g>${await getIconSVG(\"blank\", { height: iconSize, width: iconSize, fallbackPrefix: architectureIcons.prefix })}</g>`\n      );\n      const textElemContainer = bkgElem.append(\"g\");\n      const fo = textElemContainer.append(\"foreignObject\").attr(\"width\", iconSize).attr(\"height\", iconSize);\n      const divElem = fo.append(\"div\").attr(\"class\", \"node-icon-text\").attr(\"style\", `height: ${iconSize}px;`).append(\"div\").html(sanitizeText(service.iconText, config));\n      const fontSize = parseInt(\n        window.getComputedStyle(divElem.node(), null).getPropertyValue(\"font-size\").replace(/\\D/g, \"\")\n      ) ?? 16;\n      divElem.attr(\"style\", `-webkit-line-clamp: ${Math.floor((iconSize - 2) / fontSize)};`);\n    } else {\n      bkgElem.append(\"path\").attr(\"class\", \"node-bkg\").attr(\"id\", \"node-\" + service.id).attr(\n        \"d\",\n        `M0 ${iconSize} v${-iconSize} q0,-5 5,-5 h${iconSize} q5,0 5,5 v${iconSize} H0 Z`\n      );\n    }\n    serviceElem.attr(\"id\", `service-${service.id}`).attr(\"class\", \"architecture-service\");\n    const { width, height } = serviceElem.node().getBBox();\n    service.width = width;\n    service.height = height;\n    db.setElementForId(service.id, serviceElem);\n  }\n  return 0;\n}, \"drawServices\");\nvar drawJunctions = /* @__PURE__ */ __name(function(db, elem, junctions) {\n  junctions.forEach((junction) => {\n    const junctionElem = elem.append(\"g\");\n    const iconSize = db.getConfigField(\"iconSize\");\n    const bkgElem = junctionElem.append(\"g\");\n    bkgElem.append(\"rect\").attr(\"id\", \"node-\" + junction.id).attr(\"fill-opacity\", \"0\").attr(\"width\", iconSize).attr(\"height\", iconSize);\n    junctionElem.attr(\"class\", \"architecture-junction\");\n    const { width, height } = junctionElem._groups[0][0].getBBox();\n    junctionElem.width = width;\n    junctionElem.height = height;\n    db.setElementForId(junction.id, junctionElem);\n  });\n}, \"drawJunctions\");\n\n// src/diagrams/architecture/architectureRenderer.ts\nregisterIconPacks([\n  {\n    name: architectureIcons.prefix,\n    icons: architectureIcons\n  }\n]);\ncytoscape.use(fcose);\nfunction addServices(services, cy, db) {\n  services.forEach((service) => {\n    cy.add({\n      group: \"nodes\",\n      data: {\n        type: \"service\",\n        id: service.id,\n        icon: service.icon,\n        label: service.title,\n        parent: service.in,\n        width: db.getConfigField(\"iconSize\"),\n        height: db.getConfigField(\"iconSize\")\n      },\n      classes: \"node-service\"\n    });\n  });\n}\n__name(addServices, \"addServices\");\nfunction addJunctions(junctions, cy, db) {\n  junctions.forEach((junction) => {\n    cy.add({\n      group: \"nodes\",\n      data: {\n        type: \"junction\",\n        id: junction.id,\n        parent: junction.in,\n        width: db.getConfigField(\"iconSize\"),\n        height: db.getConfigField(\"iconSize\")\n      },\n      classes: \"node-junction\"\n    });\n  });\n}\n__name(addJunctions, \"addJunctions\");\nfunction positionNodes(db, cy) {\n  cy.nodes().map((node) => {\n    const data = nodeData(node);\n    if (data.type === \"group\") {\n      return;\n    }\n    data.x = node.position().x;\n    data.y = node.position().y;\n    const nodeElem = db.getElementById(data.id);\n    nodeElem.attr(\"transform\", \"translate(\" + (data.x || 0) + \",\" + (data.y || 0) + \")\");\n  });\n}\n__name(positionNodes, \"positionNodes\");\nfunction addGroups(groups, cy) {\n  groups.forEach((group) => {\n    cy.add({\n      group: \"nodes\",\n      data: {\n        type: \"group\",\n        id: group.id,\n        icon: group.icon,\n        label: group.title,\n        parent: group.in\n      },\n      classes: \"node-group\"\n    });\n  });\n}\n__name(addGroups, \"addGroups\");\nfunction addEdges(edges, cy) {\n  edges.forEach((parsedEdge) => {\n    const { lhsId, rhsId, lhsInto, lhsGroup, rhsInto, lhsDir, rhsDir, rhsGroup, title } = parsedEdge;\n    const edgeType = isArchitectureDirectionXY(parsedEdge.lhsDir, parsedEdge.rhsDir) ? \"segments\" : \"straight\";\n    const edge = {\n      id: `${lhsId}-${rhsId}`,\n      label: title,\n      source: lhsId,\n      sourceDir: lhsDir,\n      sourceArrow: lhsInto,\n      sourceGroup: lhsGroup,\n      sourceEndpoint: lhsDir === \"L\" ? \"0 50%\" : lhsDir === \"R\" ? \"100% 50%\" : lhsDir === \"T\" ? \"50% 0\" : \"50% 100%\",\n      target: rhsId,\n      targetDir: rhsDir,\n      targetArrow: rhsInto,\n      targetGroup: rhsGroup,\n      targetEndpoint: rhsDir === \"L\" ? \"0 50%\" : rhsDir === \"R\" ? \"100% 50%\" : rhsDir === \"T\" ? \"50% 0\" : \"50% 100%\"\n    };\n    cy.add({\n      group: \"edges\",\n      data: edge,\n      classes: edgeType\n    });\n  });\n}\n__name(addEdges, \"addEdges\");\nfunction getAlignments(db, spatialMaps, groupAlignments) {\n  const flattenAlignments = /* @__PURE__ */ __name((alignmentObj, alignmentDir) => {\n    return Object.entries(alignmentObj).reduce(\n      (prev, [dir, alignments2]) => {\n        let cnt = 0;\n        const arr = Object.entries(alignments2);\n        if (arr.length === 1) {\n          prev[dir] = arr[0][1];\n          return prev;\n        }\n        for (let i = 0; i < arr.length - 1; i++) {\n          for (let j = i + 1; j < arr.length; j++) {\n            const [aGroupId, aNodeIds] = arr[i];\n            const [bGroupId, bNodeIds] = arr[j];\n            const alignment = groupAlignments[aGroupId]?.[bGroupId];\n            if (alignment === alignmentDir) {\n              prev[dir] ??= [];\n              prev[dir] = [...prev[dir], ...aNodeIds, ...bNodeIds];\n            } else if (aGroupId === \"default\" || bGroupId === \"default\") {\n              prev[dir] ??= [];\n              prev[dir] = [...prev[dir], ...aNodeIds, ...bNodeIds];\n            } else {\n              const keyA = `${dir}-${cnt++}`;\n              prev[keyA] = aNodeIds;\n              const keyB = `${dir}-${cnt++}`;\n              prev[keyB] = bNodeIds;\n            }\n          }\n        }\n        return prev;\n      },\n      {}\n    );\n  }, \"flattenAlignments\");\n  const alignments = spatialMaps.map((spatialMap) => {\n    const horizontalAlignments = {};\n    const verticalAlignments = {};\n    Object.entries(spatialMap).forEach(([id, [x, y]]) => {\n      const nodeGroup = db.getNode(id)?.in ?? \"default\";\n      horizontalAlignments[y] ??= {};\n      horizontalAlignments[y][nodeGroup] ??= [];\n      horizontalAlignments[y][nodeGroup].push(id);\n      verticalAlignments[x] ??= {};\n      verticalAlignments[x][nodeGroup] ??= [];\n      verticalAlignments[x][nodeGroup].push(id);\n    });\n    return {\n      horiz: Object.values(flattenAlignments(horizontalAlignments, \"horizontal\")).filter(\n        (arr) => arr.length > 1\n      ),\n      vert: Object.values(flattenAlignments(verticalAlignments, \"vertical\")).filter(\n        (arr) => arr.length > 1\n      )\n    };\n  });\n  const [horizontal, vertical] = alignments.reduce(\n    ([prevHoriz, prevVert], { horiz, vert }) => {\n      return [\n        [...prevHoriz, ...horiz],\n        [...prevVert, ...vert]\n      ];\n    },\n    [[], []]\n  );\n  return {\n    horizontal,\n    vertical\n  };\n}\n__name(getAlignments, \"getAlignments\");\nfunction getRelativeConstraints(spatialMaps, db) {\n  const relativeConstraints = [];\n  const posToStr = /* @__PURE__ */ __name((pos) => `${pos[0]},${pos[1]}`, \"posToStr\");\n  const strToPos = /* @__PURE__ */ __name((pos) => pos.split(\",\").map((p) => parseInt(p)), \"strToPos\");\n  spatialMaps.forEach((spatialMap) => {\n    const invSpatialMap = Object.fromEntries(\n      Object.entries(spatialMap).map(([id, pos]) => [posToStr(pos), id])\n    );\n    const queue = [posToStr([0, 0])];\n    const visited = {};\n    const directions = {\n      L: [-1, 0],\n      R: [1, 0],\n      T: [0, 1],\n      B: [0, -1]\n    };\n    while (queue.length > 0) {\n      const curr = queue.shift();\n      if (curr) {\n        visited[curr] = 1;\n        const currId = invSpatialMap[curr];\n        if (currId) {\n          const currPos = strToPos(curr);\n          Object.entries(directions).forEach(([dir, shift]) => {\n            const newPos = posToStr([currPos[0] + shift[0], currPos[1] + shift[1]]);\n            const newId = invSpatialMap[newPos];\n            if (newId && !visited[newPos]) {\n              queue.push(newPos);\n              relativeConstraints.push({\n                [ArchitectureDirectionName[dir]]: newId,\n                [ArchitectureDirectionName[getOppositeArchitectureDirection(dir)]]: currId,\n                gap: 1.5 * db.getConfigField(\"iconSize\")\n              });\n            }\n          });\n        }\n      }\n    }\n  });\n  return relativeConstraints;\n}\n__name(getRelativeConstraints, \"getRelativeConstraints\");\nfunction layoutArchitecture(services, junctions, groups, edges, db, { spatialMaps, groupAlignments }) {\n  return new Promise((resolve) => {\n    const renderEl = select(\"body\").append(\"div\").attr(\"id\", \"cy\").attr(\"style\", \"display:none\");\n    const cy = cytoscape({\n      container: document.getElementById(\"cy\"),\n      style: [\n        {\n          selector: \"edge\",\n          style: {\n            \"curve-style\": \"straight\",\n            label: \"data(label)\",\n            \"source-endpoint\": \"data(sourceEndpoint)\",\n            \"target-endpoint\": \"data(targetEndpoint)\"\n          }\n        },\n        {\n          selector: \"edge.segments\",\n          style: {\n            \"curve-style\": \"segments\",\n            \"segment-weights\": \"0\",\n            \"segment-distances\": [0.5],\n            // @ts-ignore Incorrect library types\n            \"edge-distances\": \"endpoints\",\n            \"source-endpoint\": \"data(sourceEndpoint)\",\n            \"target-endpoint\": \"data(targetEndpoint)\"\n          }\n        },\n        {\n          selector: \"node\",\n          style: {\n            // @ts-ignore Incorrect library types\n            \"compound-sizing-wrt-labels\": \"include\"\n          }\n        },\n        {\n          selector: \"node[label]\",\n          style: {\n            \"text-valign\": \"bottom\",\n            \"text-halign\": \"center\",\n            \"font-size\": `${db.getConfigField(\"fontSize\")}px`\n          }\n        },\n        {\n          selector: \".node-service\",\n          style: {\n            label: \"data(label)\",\n            width: \"data(width)\",\n            height: \"data(height)\"\n          }\n        },\n        {\n          selector: \".node-junction\",\n          style: {\n            width: \"data(width)\",\n            height: \"data(height)\"\n          }\n        },\n        {\n          selector: \".node-group\",\n          style: {\n            // @ts-ignore Incorrect library types\n            padding: `${db.getConfigField(\"padding\")}px`\n          }\n        }\n      ],\n      layout: {\n        name: \"grid\",\n        boundingBox: {\n          x1: 0,\n          x2: 100,\n          y1: 0,\n          y2: 100\n        }\n      }\n    });\n    renderEl.remove();\n    addGroups(groups, cy);\n    addServices(services, cy, db);\n    addJunctions(junctions, cy, db);\n    addEdges(edges, cy);\n    const alignmentConstraint = getAlignments(db, spatialMaps, groupAlignments);\n    const relativePlacementConstraint = getRelativeConstraints(spatialMaps, db);\n    const layout = cy.layout({\n      name: \"fcose\",\n      quality: \"proof\",\n      styleEnabled: false,\n      animate: false,\n      nodeDimensionsIncludeLabels: false,\n      // Adjust the edge parameters if it passes through the border of a group\n      // Hacky fix for: https://github.com/iVis-at-Bilkent/cytoscape.js-fcose/issues/67\n      idealEdgeLength(edge) {\n        const [nodeA, nodeB] = edge.connectedNodes();\n        const { parent: parentA } = nodeData(nodeA);\n        const { parent: parentB } = nodeData(nodeB);\n        const elasticity = parentA === parentB ? 1.5 * db.getConfigField(\"iconSize\") : 0.5 * db.getConfigField(\"iconSize\");\n        return elasticity;\n      },\n      edgeElasticity(edge) {\n        const [nodeA, nodeB] = edge.connectedNodes();\n        const { parent: parentA } = nodeData(nodeA);\n        const { parent: parentB } = nodeData(nodeB);\n        const elasticity = parentA === parentB ? 0.45 : 1e-3;\n        return elasticity;\n      },\n      alignmentConstraint,\n      relativePlacementConstraint\n    });\n    layout.one(\"layoutstop\", () => {\n      function getSegmentWeights(source, target, pointX, pointY) {\n        let W, D;\n        const { x: sX, y: sY } = source;\n        const { x: tX, y: tY } = target;\n        D = (pointY - sY + (sX - pointX) * (sY - tY) / (sX - tX)) / Math.sqrt(1 + Math.pow((sY - tY) / (sX - tX), 2));\n        W = Math.sqrt(Math.pow(pointY - sY, 2) + Math.pow(pointX - sX, 2) - Math.pow(D, 2));\n        const distAB = Math.sqrt(Math.pow(tX - sX, 2) + Math.pow(tY - sY, 2));\n        W = W / distAB;\n        let delta1 = (tX - sX) * (pointY - sY) - (tY - sY) * (pointX - sX);\n        switch (true) {\n          case delta1 >= 0:\n            delta1 = 1;\n            break;\n          case delta1 < 0:\n            delta1 = -1;\n            break;\n        }\n        let delta2 = (tX - sX) * (pointX - sX) + (tY - sY) * (pointY - sY);\n        switch (true) {\n          case delta2 >= 0:\n            delta2 = 1;\n            break;\n          case delta2 < 0:\n            delta2 = -1;\n            break;\n        }\n        D = Math.abs(D) * delta1;\n        W = W * delta2;\n        return {\n          distances: D,\n          weights: W\n        };\n      }\n      __name(getSegmentWeights, \"getSegmentWeights\");\n      cy.startBatch();\n      for (const edge of Object.values(cy.edges())) {\n        if (edge.data?.()) {\n          const { x: sX, y: sY } = edge.source().position();\n          const { x: tX, y: tY } = edge.target().position();\n          if (sX !== tX && sY !== tY) {\n            const sEP = edge.sourceEndpoint();\n            const tEP = edge.targetEndpoint();\n            const { sourceDir } = edgeData(edge);\n            const [pointX, pointY] = isArchitectureDirectionY(sourceDir) ? [sEP.x, tEP.y] : [tEP.x, sEP.y];\n            const { weights, distances } = getSegmentWeights(sEP, tEP, pointX, pointY);\n            edge.style(\"segment-distances\", distances);\n            edge.style(\"segment-weights\", weights);\n          }\n        }\n      }\n      cy.endBatch();\n      layout.run();\n    });\n    layout.run();\n    cy.ready((e) => {\n      log.info(\"Ready\", e);\n      resolve(cy);\n    });\n  });\n}\n__name(layoutArchitecture, \"layoutArchitecture\");\nvar draw = /* @__PURE__ */ __name(async (text, id, _version, diagObj) => {\n  const db = diagObj.db;\n  const services = db.getServices();\n  const junctions = db.getJunctions();\n  const groups = db.getGroups();\n  const edges = db.getEdges();\n  const ds = db.getDataStructures();\n  const svg = selectSvgElement(id);\n  const edgesElem = svg.append(\"g\");\n  edgesElem.attr(\"class\", \"architecture-edges\");\n  const servicesElem = svg.append(\"g\");\n  servicesElem.attr(\"class\", \"architecture-services\");\n  const groupElem = svg.append(\"g\");\n  groupElem.attr(\"class\", \"architecture-groups\");\n  await drawServices(db, servicesElem, services);\n  drawJunctions(db, servicesElem, junctions);\n  const cy = await layoutArchitecture(services, junctions, groups, edges, db, ds);\n  await drawEdges(edgesElem, cy, db);\n  await drawGroups(groupElem, cy, db);\n  positionNodes(db, cy);\n  setupGraphViewbox(void 0, svg, db.getConfigField(\"padding\"), db.getConfigField(\"useMaxWidth\"));\n}, \"draw\");\nvar renderer = { draw };\n\n// src/diagrams/architecture/architectureDiagram.ts\nvar diagram = {\n  parser,\n  get db() {\n    return new ArchitectureDB();\n  },\n  renderer,\n  styles: architectureStyles_default\n};\nexport {\n  diagram\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}